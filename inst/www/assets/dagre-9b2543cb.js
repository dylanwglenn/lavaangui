import{r as hr}from"./graphlib-a6487d85.js";import{r as lr,a as vr,b as pr,c as mr,e as wr,f as br,h as Er,i as gr,j as yr,k as kr,l as xr,m as qr,n as Rr,o as _r,p as Nr,q as Lr,u as Cr,v as Ir,w as Sr,x as Tr,y as Mr,z as Gr,A as Br,B as Pr,C as Or,D as Dr}from"./lodash-6eb5ace2.js";function ur(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var K,Se;function Y(){if(Se)return K;Se=1;var e;if(typeof ur=="function")try{e=hr()}catch{}return e||(e=window.graphlib),K=e,K}var Q,Te;function O(){if(Te)return Q;Te=1;var e;if(typeof ur=="function")try{e={cloneDeep:lr(),constant:vr(),defaults:pr(),each:mr(),filter:wr(),find:br(),flatten:Er(),forEach:gr(),forIn:yr(),has:kr(),isUndefined:xr(),last:qr(),map:Rr(),mapValues:_r(),max:Nr(),merge:Lr(),min:Cr(),minBy:Ir(),now:Sr,pick:Tr(),range:Mr(),reduce:Gr(),sortBy:Br(),uniqueId:Pr(),values:Or(),zipObject:Dr()}}catch{}return e||(e=window._),Q=e,Q}var ee,Me;function Fr(){if(Me)return ee;Me=1,ee=e;function e(){var b={};b._next=b._prev=b,this._sentinel=b}e.prototype.dequeue=function(){var b=this._sentinel,d=b._prev;if(d!==b)return N(d),d},e.prototype.enqueue=function(b){var d=this._sentinel;b._prev&&b._next&&N(b),b._next=d._next,d._next._prev=b,d._next=b,b._prev=d},e.prototype.toString=function(){for(var b=[],d=this._sentinel,t=d._prev;t!==d;)b.push(JSON.stringify(t,q)),t=t._prev;return"["+b.join(", ")+"]"};function N(b){b._prev._next=b._next,b._next._prev=b._prev,delete b._next,delete b._prev}function q(b,d){if(b!=="_next"&&b!=="_prev")return d}return ee}var re,Ge;function Vr(){if(Ge)return re;Ge=1;var e=O(),N=Y().Graph,q=Fr();re=d;var b=e.constant(1);function d(n,i){if(n.nodeCount()<=1)return[];var m=r(n,i||b),f=t(m.graph,m.buckets,m.zeroIdx);return e.flatten(e.map(f,function(E){return n.outEdges(E.v,E.w)}),!0)}function t(n,i,m){for(var f=[],E=i[i.length-1],I=i[0],x;n.nodeCount();){for(;x=I.dequeue();)u(n,i,m,x);for(;x=E.dequeue();)u(n,i,m,x);if(n.nodeCount()){for(var p=i.length-2;p>0;--p)if(x=i[p].dequeue(),x){f=f.concat(u(n,i,m,x,!0));break}}}return f}function u(n,i,m,f,E){var I=E?[]:void 0;return e.forEach(n.inEdges(f.v),function(x){var p=n.edge(x),l=n.node(x.v);E&&I.push({v:x.v,w:x.w}),l.out-=p,a(i,m,l)}),e.forEach(n.outEdges(f.v),function(x){var p=n.edge(x),l=x.w,s=n.node(l);s.in-=p,a(i,m,s)}),n.removeNode(f.v),I}function r(n,i){var m=new N,f=0,E=0;e.forEach(n.nodes(),function(p){m.setNode(p,{v:p,in:0,out:0})}),e.forEach(n.edges(),function(p){var l=m.edge(p.v,p.w)||0,s=i(p),o=l+s;m.setEdge(p.v,p.w,o),E=Math.max(E,m.node(p.v).out+=s),f=Math.max(f,m.node(p.w).in+=s)});var I=e.range(E+f+3).map(function(){return new q}),x=f+1;return e.forEach(m.nodes(),function(p){a(I,x,m.node(p))}),{graph:m,buckets:I,zeroIdx:x}}function a(n,i,m){m.out?m.in?n[m.out-m.in+i].enqueue(m):n[n.length-1].enqueue(m):n[0].enqueue(m)}return re}var ne,Be;function Ar(){if(Be)return ne;Be=1;var e=O(),N=Vr();ne={run:q,undo:d};function q(t){var u=t.graph().acyclicer==="greedy"?N(t,r(t)):b(t);e.forEach(u,function(a){var n=t.edge(a);t.removeEdge(a),n.forwardName=a.name,n.reversed=!0,t.setEdge(a.w,a.v,n,e.uniqueId("rev"))});function r(a){return function(n){return a.edge(n).weight}}}function b(t){var u=[],r={},a={};function n(i){e.has(a,i)||(a[i]=!0,r[i]=!0,e.forEach(t.outEdges(i),function(m){e.has(r,m.w)?u.push(m):n(m.w)}),delete r[i])}return e.forEach(t.nodes(),n),u}function d(t){e.forEach(t.edges(),function(u){var r=t.edge(u);if(r.reversed){t.removeEdge(u);var a=r.forwardName;delete r.reversed,delete r.forwardName,t.setEdge(u.w,u.v,r,a)}})}return ne}var ae,Pe;function U(){if(Pe)return ae;Pe=1;var e=O(),N=Y().Graph;ae={addDummyNode:q,simplify:b,asNonCompoundGraph:d,successorWeights:t,predecessorWeights:u,intersectRect:r,buildLayerMatrix:a,normalizeRanks:n,removeEmptyRanks:i,addBorderNode:m,maxRank:f,partition:E,time:I,notime:x};function q(p,l,s,o){var h;do h=e.uniqueId(o);while(p.hasNode(h));return s.dummy=l,p.setNode(h,s),h}function b(p){var l=new N().setGraph(p.graph());return e.forEach(p.nodes(),function(s){l.setNode(s,p.node(s))}),e.forEach(p.edges(),function(s){var o=l.edge(s.v,s.w)||{weight:0,minlen:1},h=p.edge(s);l.setEdge(s.v,s.w,{weight:o.weight+h.weight,minlen:Math.max(o.minlen,h.minlen)})}),l}function d(p){var l=new N({multigraph:p.isMultigraph()}).setGraph(p.graph());return e.forEach(p.nodes(),function(s){p.children(s).length||l.setNode(s,p.node(s))}),e.forEach(p.edges(),function(s){l.setEdge(s,p.edge(s))}),l}function t(p){var l=e.map(p.nodes(),function(s){var o={};return e.forEach(p.outEdges(s),function(h){o[h.w]=(o[h.w]||0)+p.edge(h).weight}),o});return e.zipObject(p.nodes(),l)}function u(p){var l=e.map(p.nodes(),function(s){var o={};return e.forEach(p.inEdges(s),function(h){o[h.v]=(o[h.v]||0)+p.edge(h).weight}),o});return e.zipObject(p.nodes(),l)}function r(p,l){var s=p.x,o=p.y,h=l.x-s,v=l.y-o,y=p.width/2,k=p.height/2;if(!h&&!v)throw new Error("Not possible to find intersection inside of the rectangle");var C,R;return Math.abs(v)*y>Math.abs(h)*k?(v<0&&(k=-k),C=k*h/v,R=k):(h<0&&(y=-y),C=y,R=y*v/h),{x:s+C,y:o+R}}function a(p){var l=e.map(e.range(f(p)+1),function(){return[]});return e.forEach(p.nodes(),function(s){var o=p.node(s),h=o.rank;e.isUndefined(h)||(l[h][o.order]=s)}),l}function n(p){var l=e.min(e.map(p.nodes(),function(s){return p.node(s).rank}));e.forEach(p.nodes(),function(s){var o=p.node(s);e.has(o,"rank")&&(o.rank-=l)})}function i(p){var l=e.min(e.map(p.nodes(),function(v){return p.node(v).rank})),s=[];e.forEach(p.nodes(),function(v){var y=p.node(v).rank-l;s[y]||(s[y]=[]),s[y].push(v)});var o=0,h=p.graph().nodeRankFactor;e.forEach(s,function(v,y){e.isUndefined(v)&&y%h!==0?--o:o&&e.forEach(v,function(k){p.node(k).rank+=o})})}function m(p,l,s,o){var h={width:0,height:0};return arguments.length>=4&&(h.rank=s,h.order=o),q(p,"border",h,l)}function f(p){return e.max(e.map(p.nodes(),function(l){var s=p.node(l).rank;if(!e.isUndefined(s))return s}))}function E(p,l){var s={lhs:[],rhs:[]};return e.forEach(p,function(o){l(o)?s.lhs.push(o):s.rhs.push(o)}),s}function I(p,l){var s=e.now();try{return l()}finally{console.log(p+" time: "+(e.now()-s)+"ms")}}function x(p,l){return l()}return ae}var ie,Oe;function Ur(){if(Oe)return ie;Oe=1;var e=O(),N=U();ie={run:q,undo:d};function q(t){t.graph().dummyChains=[],e.forEach(t.edges(),function(u){b(t,u)})}function b(t,u){var r=u.v,a=t.node(r).rank,n=u.w,i=t.node(n).rank,m=u.name,f=t.edge(u),E=f.labelRank;if(i!==a+1){t.removeEdge(u);var I,x,p;for(p=0,++a;a<i;++p,++a)f.points=[],x={width:0,height:0,edgeLabel:f,edgeObj:u,rank:a},I=N.addDummyNode(t,"edge",x,"_d"),a===E&&(x.width=f.width,x.height=f.height,x.dummy="edge-label",x.labelpos=f.labelpos),t.setEdge(r,I,{weight:f.weight},m),p===0&&t.graph().dummyChains.push(I),r=I;t.setEdge(r,n,{weight:f.weight},m)}}function d(t){e.forEach(t.graph().dummyChains,function(u){var r=t.node(u),a=r.edgeLabel,n;for(t.setEdge(r.edgeObj,a);r.dummy;)n=t.successors(u)[0],t.removeNode(u),a.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(a.x=r.x,a.y=r.y,a.width=r.width,a.height=r.height),u=n,r=t.node(u)})}return ie}var te,De;function $(){if(De)return te;De=1;var e=O();te={longestPath:N,slack:q};function N(b){var d={};function t(u){var r=b.node(u);if(e.has(d,u))return r.rank;d[u]=!0;var a=e.min(e.map(b.outEdges(u),function(n){return t(n.w)-b.edge(n).minlen}));return(a===Number.POSITIVE_INFINITY||a===void 0||a===null)&&(a=0),r.rank=a}e.forEach(b.sources(),t)}function q(b,d){return b.node(d.w).rank-b.node(d.v).rank-b.edge(d).minlen}return te}var oe,Fe;function dr(){if(Fe)return oe;Fe=1;var e=O(),N=Y().Graph,q=$().slack;oe=b;function b(r){var a=new N({directed:!1}),n=r.nodes()[0],i=r.nodeCount();a.setNode(n,{});for(var m,f;d(a,r)<i;)m=t(a,r),f=a.hasNode(m.v)?q(r,m):-q(r,m),u(a,r,f);return a}function d(r,a){function n(i){e.forEach(a.nodeEdges(i),function(m){var f=m.v,E=i===f?m.w:f;!r.hasNode(E)&&!q(a,m)&&(r.setNode(E,{}),r.setEdge(i,E,{}),n(E))})}return e.forEach(r.nodes(),n),r.nodeCount()}function t(r,a){return e.minBy(a.edges(),function(n){if(r.hasNode(n.v)!==r.hasNode(n.w))return q(a,n)})}function u(r,a,n){e.forEach(r.nodes(),function(i){a.node(i).rank+=n})}return oe}var ue,Ve;function jr(){if(Ve)return ue;Ve=1;var e=O(),N=dr(),q=$().slack,b=$().longestPath,d=Y().alg.preorder,t=Y().alg.postorder,u=U().simplify;ue=r,r.initLowLimValues=m,r.initCutValues=a,r.calcCutValue=i,r.leaveEdge=E,r.enterEdge=I,r.exchangeEdges=x;function r(o){o=u(o),b(o);var h=N(o);m(h),a(h,o);for(var v,y;v=E(h);)y=I(h,o,v),x(h,o,v,y)}function a(o,h){var v=t(o,o.nodes());v=v.slice(0,v.length-1),e.forEach(v,function(y){n(o,h,y)})}function n(o,h,v){var y=o.node(v),k=y.parent;o.edge(v,k).cutvalue=i(o,h,v)}function i(o,h,v){var y=o.node(v),k=y.parent,C=!0,R=h.edge(v,k),L=0;return R||(C=!1,R=h.edge(k,v)),L=R.weight,e.forEach(h.nodeEdges(v),function(S){var T=S.v===v,G=T?S.w:S.v;if(G!==k){var B=T===C,P=h.edge(S).weight;if(L+=B?P:-P,l(o,v,G)){var V=o.edge(v,G).cutvalue;L+=B?-V:V}}}),L}function m(o,h){arguments.length<2&&(h=o.nodes()[0]),f(o,{},1,h)}function f(o,h,v,y,k){var C=v,R=o.node(y);return h[y]=!0,e.forEach(o.neighbors(y),function(L){e.has(h,L)||(v=f(o,h,v,L,y))}),R.low=C,R.lim=v++,k?R.parent=k:delete R.parent,v}function E(o){return e.find(o.edges(),function(h){return o.edge(h).cutvalue<0})}function I(o,h,v){var y=v.v,k=v.w;h.hasEdge(y,k)||(y=v.w,k=v.v);var C=o.node(y),R=o.node(k),L=C,S=!1;C.lim>R.lim&&(L=R,S=!0);var T=e.filter(h.edges(),function(G){return S===s(o,o.node(G.v),L)&&S!==s(o,o.node(G.w),L)});return e.minBy(T,function(G){return q(h,G)})}function x(o,h,v,y){var k=v.v,C=v.w;o.removeEdge(k,C),o.setEdge(y.v,y.w,{}),m(o),a(o,h),p(o,h)}function p(o,h){var v=e.find(o.nodes(),function(k){return!h.node(k).parent}),y=d(o,v);y=y.slice(1),e.forEach(y,function(k){var C=o.node(k).parent,R=h.edge(k,C),L=!1;R||(R=h.edge(C,k),L=!0),h.node(k).rank=h.node(C).rank+(L?R.minlen:-R.minlen)})}function l(o,h,v){return o.hasEdge(h,v)}function s(o,h,v){return v.low<=h.lim&&h.lim<=v.lim}return ue}var de,Ae;function zr(){if(Ae)return de;Ae=1;var e=$(),N=e.longestPath,q=dr(),b=jr();de=d;function d(a){switch(a.graph().ranker){case"network-simplex":r(a);break;case"tight-tree":u(a);break;case"longest-path":t(a);break;default:r(a)}}var t=N;function u(a){N(a),q(a)}function r(a){b(a)}return de}var se,Ue;function Yr(){if(Ue)return se;Ue=1;var e=O();se=N;function N(d){var t=b(d);e.forEach(d.graph().dummyChains,function(u){for(var r=d.node(u),a=r.edgeObj,n=q(d,t,a.v,a.w),i=n.path,m=n.lca,f=0,E=i[f],I=!0;u!==a.w;){if(r=d.node(u),I){for(;(E=i[f])!==m&&d.node(E).maxRank<r.rank;)f++;E===m&&(I=!1)}if(!I){for(;f<i.length-1&&d.node(E=i[f+1]).minRank<=r.rank;)f++;E=i[f]}d.setParent(u,E),u=d.successors(u)[0]}})}function q(d,t,u,r){var a=[],n=[],i=Math.min(t[u].low,t[r].low),m=Math.max(t[u].lim,t[r].lim),f,E;f=u;do f=d.parent(f),a.push(f);while(f&&(t[f].low>i||m>t[f].lim));for(E=f,f=r;(f=d.parent(f))!==E;)n.push(f);return{path:a.concat(n.reverse()),lca:E}}function b(d){var t={},u=0;function r(a){var n=u;e.forEach(d.children(a),r),t[a]={low:n,lim:u++}}return e.forEach(d.children(),r),t}return se}var fe,je;function Wr(){if(je)return fe;je=1;var e=O(),N=U();fe={run:q,cleanup:u};function q(r){var a=N.addDummyNode(r,"root",{},"_root"),n=d(r),i=e.max(e.values(n))-1,m=2*i+1;r.graph().nestingRoot=a,e.forEach(r.edges(),function(E){r.edge(E).minlen*=m});var f=t(r)+1;e.forEach(r.children(),function(E){b(r,a,m,f,i,n,E)}),r.graph().nodeRankFactor=m}function b(r,a,n,i,m,f,E){var I=r.children(E);if(!I.length){E!==a&&r.setEdge(a,E,{weight:0,minlen:n});return}var x=N.addBorderNode(r,"_bt"),p=N.addBorderNode(r,"_bb"),l=r.node(E);r.setParent(x,E),l.borderTop=x,r.setParent(p,E),l.borderBottom=p,e.forEach(I,function(s){b(r,a,n,i,m,f,s);var o=r.node(s),h=o.borderTop?o.borderTop:s,v=o.borderBottom?o.borderBottom:s,y=o.borderTop?i:2*i,k=h!==v?1:m-f[E]+1;r.setEdge(x,h,{weight:y,minlen:k,nestingEdge:!0}),r.setEdge(v,p,{weight:y,minlen:k,nestingEdge:!0})}),r.parent(E)||r.setEdge(a,x,{weight:0,minlen:m+f[E]})}function d(r){var a={};function n(i,m){var f=r.children(i);f&&f.length&&e.forEach(f,function(E){n(E,m+1)}),a[i]=m}return e.forEach(r.children(),function(i){n(i,1)}),a}function t(r){return e.reduce(r.edges(),function(a,n){return a+r.edge(n).weight},0)}function u(r){var a=r.graph();r.removeNode(a.nestingRoot),delete a.nestingRoot,e.forEach(r.edges(),function(n){var i=r.edge(n);i.nestingEdge&&r.removeEdge(n)})}return fe}var ce,ze;function Xr(){if(ze)return ce;ze=1;var e=O(),N=U();ce=q;function q(d){function t(u){var r=d.children(u),a=d.node(u);if(r.length&&e.forEach(r,t),e.has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var n=a.minRank,i=a.maxRank+1;n<i;++n)b(d,"borderLeft","_bl",u,a,n),b(d,"borderRight","_br",u,a,n)}}e.forEach(d.children(),t)}function b(d,t,u,r,a,n){var i={width:0,height:0,rank:n,borderType:t},m=a[t][n-1],f=N.addDummyNode(d,"border",i,u);a[t][n]=f,d.setParent(f,r),m&&d.setEdge(m,f,{weight:1})}return ce}var he,Ye;function Hr(){if(Ye)return he;Ye=1;var e=O();he={adjust:N,undo:q};function N(n){var i=n.graph().rankdir.toLowerCase();(i==="lr"||i==="rl")&&b(n)}function q(n){var i=n.graph().rankdir.toLowerCase();(i==="bt"||i==="rl")&&t(n),(i==="lr"||i==="rl")&&(r(n),b(n))}function b(n){e.forEach(n.nodes(),function(i){d(n.node(i))}),e.forEach(n.edges(),function(i){d(n.edge(i))})}function d(n){var i=n.width;n.width=n.height,n.height=i}function t(n){e.forEach(n.nodes(),function(i){u(n.node(i))}),e.forEach(n.edges(),function(i){var m=n.edge(i);e.forEach(m.points,u),e.has(m,"y")&&u(m)})}function u(n){n.y=-n.y}function r(n){e.forEach(n.nodes(),function(i){a(n.node(i))}),e.forEach(n.edges(),function(i){var m=n.edge(i);e.forEach(m.points,a),e.has(m,"x")&&a(m)})}function a(n){var i=n.x;n.x=n.y,n.y=i}return he}var le,We;function $r(){if(We)return le;We=1;var e=O();le=N;function N(q){var b={},d=e.filter(q.nodes(),function(n){return!q.children(n).length}),t=e.max(e.map(d,function(n){return q.node(n).rank})),u=e.map(e.range(t+1),function(){return[]});function r(n){if(!e.has(b,n)){b[n]=!0;var i=q.node(n);u[i.rank].push(n),e.forEach(q.successors(n),r)}}var a=e.sortBy(d,function(n){return q.node(n).rank});return e.forEach(a,r),u}return le}var ve,Xe;function Jr(){if(Xe)return ve;Xe=1;var e=O();ve=N;function N(b,d){for(var t=0,u=1;u<d.length;++u)t+=q(b,d[u-1],d[u]);return t}function q(b,d,t){for(var u=e.zipObject(t,e.map(t,function(f,E){return E})),r=e.flatten(e.map(d,function(f){return e.sortBy(e.map(b.outEdges(f),function(E){return{pos:u[E.w],weight:b.edge(E).weight}}),"pos")}),!0),a=1;a<t.length;)a<<=1;var n=2*a-1;a-=1;var i=e.map(new Array(n),function(){return 0}),m=0;return e.forEach(r.forEach(function(f){var E=f.pos+a;i[E]+=f.weight;for(var I=0;E>0;)E%2&&(I+=i[E+1]),E=E-1>>1,i[E]+=f.weight;m+=f.weight*I})),m}return ve}var pe,He;function Zr(){if(He)return pe;He=1;var e=O();pe=N;function N(q,b){return e.map(b,function(d){var t=q.inEdges(d);if(t.length){var u=e.reduce(t,function(r,a){var n=q.edge(a),i=q.node(a.v);return{sum:r.sum+n.weight*i.order,weight:r.weight+n.weight}},{sum:0,weight:0});return{v:d,barycenter:u.sum/u.weight,weight:u.weight}}else return{v:d}})}return pe}var me,$e;function Kr(){if($e)return me;$e=1;var e=O();me=N;function N(d,t){var u={};e.forEach(d,function(a,n){var i=u[a.v]={indegree:0,in:[],out:[],vs:[a.v],i:n};e.isUndefined(a.barycenter)||(i.barycenter=a.barycenter,i.weight=a.weight)}),e.forEach(t.edges(),function(a){var n=u[a.v],i=u[a.w];!e.isUndefined(n)&&!e.isUndefined(i)&&(i.indegree++,n.out.push(u[a.w]))});var r=e.filter(u,function(a){return!a.indegree});return q(r)}function q(d){var t=[];function u(n){return function(i){i.merged||(e.isUndefined(i.barycenter)||e.isUndefined(n.barycenter)||i.barycenter>=n.barycenter)&&b(n,i)}}function r(n){return function(i){i.in.push(n),--i.indegree===0&&d.push(i)}}for(;d.length;){var a=d.pop();t.push(a),e.forEach(a.in.reverse(),u(a)),e.forEach(a.out,r(a))}return e.map(e.filter(t,function(n){return!n.merged}),function(n){return e.pick(n,["vs","i","barycenter","weight"])})}function b(d,t){var u=0,r=0;d.weight&&(u+=d.barycenter*d.weight,r+=d.weight),t.weight&&(u+=t.barycenter*t.weight,r+=t.weight),d.vs=t.vs.concat(d.vs),d.barycenter=u/r,d.weight=r,d.i=Math.min(t.i,d.i),t.merged=!0}return me}var we,Je;function Qr(){if(Je)return we;Je=1;var e=O(),N=U();we=q;function q(t,u){var r=N.partition(t,function(x){return e.has(x,"barycenter")}),a=r.lhs,n=e.sortBy(r.rhs,function(x){return-x.i}),i=[],m=0,f=0,E=0;a.sort(d(!!u)),E=b(i,n,E),e.forEach(a,function(x){E+=x.vs.length,i.push(x.vs),m+=x.barycenter*x.weight,f+=x.weight,E=b(i,n,E)});var I={vs:e.flatten(i,!0)};return f&&(I.barycenter=m/f,I.weight=f),I}function b(t,u,r){for(var a;u.length&&(a=e.last(u)).i<=r;)u.pop(),t.push(a.vs),r++;return r}function d(t){return function(u,r){return u.barycenter<r.barycenter?-1:u.barycenter>r.barycenter?1:t?r.i-u.i:u.i-r.i}}return we}var be,Ze;function en(){if(Ze)return be;Ze=1;var e=O(),N=Zr(),q=Kr(),b=Qr();be=d;function d(r,a,n,i){var m=r.children(a),f=r.node(a),E=f?f.borderLeft:void 0,I=f?f.borderRight:void 0,x={};E&&(m=e.filter(m,function(v){return v!==E&&v!==I}));var p=N(r,m);e.forEach(p,function(v){if(r.children(v.v).length){var y=d(r,v.v,n,i);x[v.v]=y,e.has(y,"barycenter")&&u(v,y)}});var l=q(p,n);t(l,x);var s=b(l,i);if(E&&(s.vs=e.flatten([E,s.vs,I],!0),r.predecessors(E).length)){var o=r.node(r.predecessors(E)[0]),h=r.node(r.predecessors(I)[0]);e.has(s,"barycenter")||(s.barycenter=0,s.weight=0),s.barycenter=(s.barycenter*s.weight+o.order+h.order)/(s.weight+2),s.weight+=2}return s}function t(r,a){e.forEach(r,function(n){n.vs=e.flatten(n.vs.map(function(i){return a[i]?a[i].vs:i}),!0)})}function u(r,a){e.isUndefined(r.barycenter)?(r.barycenter=a.barycenter,r.weight=a.weight):(r.barycenter=(r.barycenter*r.weight+a.barycenter*a.weight)/(r.weight+a.weight),r.weight+=a.weight)}return be}var Ee,Ke;function rn(){if(Ke)return Ee;Ke=1;var e=O(),N=Y().Graph;Ee=q;function q(d,t,u){var r=b(d),a=new N({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(n){return d.node(n)});return e.forEach(d.nodes(),function(n){var i=d.node(n),m=d.parent(n);(i.rank===t||i.minRank<=t&&t<=i.maxRank)&&(a.setNode(n),a.setParent(n,m||r),e.forEach(d[u](n),function(f){var E=f.v===n?f.w:f.v,I=a.edge(E,n),x=e.isUndefined(I)?0:I.weight;a.setEdge(E,n,{weight:d.edge(f).weight+x})}),e.has(i,"minRank")&&a.setNode(n,{borderLeft:i.borderLeft[t],borderRight:i.borderRight[t]}))}),a}function b(d){for(var t;d.hasNode(t=e.uniqueId("_root")););return t}return Ee}var ge,Qe;function nn(){if(Qe)return ge;Qe=1;var e=O();ge=N;function N(q,b,d){var t={},u;e.forEach(d,function(r){for(var a=q.parent(r),n,i;a;){if(n=q.parent(a),n?(i=t[n],t[n]=a):(i=u,u=a),i&&i!==a){b.setEdge(i,a);return}a=n}})}return ge}var ye,er;function an(){if(er)return ye;er=1;var e=O(),N=$r(),q=Jr(),b=en(),d=rn(),t=nn(),u=Y().Graph,r=U();ye=a;function a(f){var E=r.maxRank(f),I=n(f,e.range(1,E+1),"inEdges"),x=n(f,e.range(E-1,-1,-1),"outEdges"),p=N(f);m(f,p);for(var l=Number.POSITIVE_INFINITY,s,o=0,h=0;h<4;++o,++h){i(o%2?I:x,o%4>=2),p=r.buildLayerMatrix(f);var v=q(f,p);v<l&&(h=0,s=e.cloneDeep(p),l=v)}m(f,s)}function n(f,E,I){return e.map(E,function(x){return d(f,x,I)})}function i(f,E){var I=new u;e.forEach(f,function(x){var p=x.graph().root,l=b(x,p,I,E);e.forEach(l.vs,function(s,o){x.node(s).order=o}),t(x,I,l.vs)})}function m(f,E){e.forEach(E,function(I){e.forEach(I,function(x,p){f.node(x).order=p})})}return ye}var ke,rr;function tn(){if(rr)return ke;rr=1;var e=O(),N=Y().Graph,q=U();ke={positionX:I,findType1Conflicts:b,findType2Conflicts:d,addConflict:u,hasConflict:r,verticalAlignment:a,horizontalCompaction:n,alignCoordinates:f,findSmallestWidthAlignment:m,balance:E};function b(l,s){var o={};function h(v,y){var k=0,C=0,R=v.length,L=e.last(y);return e.forEach(y,function(S,T){var G=t(l,S),B=G?l.node(G).order:R;(G||S===L)&&(e.forEach(y.slice(C,T+1),function(P){e.forEach(l.predecessors(P),function(V){var X=l.node(V),H=X.order;(H<k||B<H)&&!(X.dummy&&l.node(P).dummy)&&u(o,V,P)})}),C=T+1,k=B)}),y}return e.reduce(s,h),o}function d(l,s){var o={};function h(y,k,C,R,L){var S;e.forEach(e.range(k,C),function(T){S=y[T],l.node(S).dummy&&e.forEach(l.predecessors(S),function(G){var B=l.node(G);B.dummy&&(B.order<R||B.order>L)&&u(o,G,S)})})}function v(y,k){var C=-1,R,L=0;return e.forEach(k,function(S,T){if(l.node(S).dummy==="border"){var G=l.predecessors(S);G.length&&(R=l.node(G[0]).order,h(k,L,T,C,R),L=T,C=R)}h(k,L,k.length,R,y.length)}),k}return e.reduce(s,v),o}function t(l,s){if(l.node(s).dummy)return e.find(l.predecessors(s),function(o){return l.node(o).dummy})}function u(l,s,o){if(s>o){var h=s;s=o,o=h}var v=l[s];v||(l[s]=v={}),v[o]=!0}function r(l,s,o){if(s>o){var h=s;s=o,o=h}return e.has(l[s],o)}function a(l,s,o,h){var v={},y={},k={};return e.forEach(s,function(C){e.forEach(C,function(R,L){v[R]=R,y[R]=R,k[R]=L})}),e.forEach(s,function(C){var R=-1;e.forEach(C,function(L){var S=h(L);if(S.length){S=e.sortBy(S,function(V){return k[V]});for(var T=(S.length-1)/2,G=Math.floor(T),B=Math.ceil(T);G<=B;++G){var P=S[G];y[L]===L&&R<k[P]&&!r(o,L,P)&&(y[P]=L,y[L]=v[L]=v[P],R=k[P])}}})}),{root:v,align:y}}function n(l,s,o,h,v){var y={},k=i(l,s,o,v),C=v?"borderLeft":"borderRight";function R(T,G){for(var B=k.nodes(),P=B.pop(),V={};P;)V[P]?T(P):(V[P]=!0,B.push(P),B=B.concat(G(P))),P=B.pop()}function L(T){y[T]=k.inEdges(T).reduce(function(G,B){return Math.max(G,y[B.v]+k.edge(B))},0)}function S(T){var G=k.outEdges(T).reduce(function(P,V){return Math.min(P,y[V.w]-k.edge(V))},Number.POSITIVE_INFINITY),B=l.node(T);G!==Number.POSITIVE_INFINITY&&B.borderType!==C&&(y[T]=Math.max(y[T],G))}return R(L,k.predecessors.bind(k)),R(S,k.successors.bind(k)),e.forEach(h,function(T){y[T]=y[o[T]]}),y}function i(l,s,o,h){var v=new N,y=l.graph(),k=x(y.nodesep,y.edgesep,h);return e.forEach(s,function(C){var R;e.forEach(C,function(L){var S=o[L];if(v.setNode(S),R){var T=o[R],G=v.edge(T,S);v.setEdge(T,S,Math.max(k(l,L,R),G||0))}R=L})}),v}function m(l,s){return e.minBy(e.values(s),function(o){var h=Number.NEGATIVE_INFINITY,v=Number.POSITIVE_INFINITY;return e.forIn(o,function(y,k){var C=p(l,k)/2;h=Math.max(y+C,h),v=Math.min(y-C,v)}),h-v})}function f(l,s){var o=e.values(s),h=e.min(o),v=e.max(o);e.forEach(["u","d"],function(y){e.forEach(["l","r"],function(k){var C=y+k,R=l[C],L;if(R!==s){var S=e.values(R);L=k==="l"?h-e.min(S):v-e.max(S),L&&(l[C]=e.mapValues(R,function(T){return T+L}))}})})}function E(l,s){return e.mapValues(l.ul,function(o,h){if(s)return l[s.toLowerCase()][h];var v=e.sortBy(e.map(l,h));return(v[1]+v[2])/2})}function I(l){var s=q.buildLayerMatrix(l),o=e.merge(b(l,s),d(l,s)),h={},v;e.forEach(["u","d"],function(k){v=k==="u"?s:e.values(s).reverse(),e.forEach(["l","r"],function(C){C==="r"&&(v=e.map(v,function(T){return e.values(T).reverse()}));var R=(k==="u"?l.predecessors:l.successors).bind(l),L=a(l,v,o,R),S=n(l,v,L.root,L.align,C==="r");C==="r"&&(S=e.mapValues(S,function(T){return-T})),h[k+C]=S})});var y=m(l,h);return f(h,y),E(h,l.graph().align)}function x(l,s,o){return function(h,v,y){var k=h.node(v),C=h.node(y),R=0,L;if(R+=k.width/2,e.has(k,"labelpos"))switch(k.labelpos.toLowerCase()){case"l":L=-k.width/2;break;case"r":L=k.width/2;break}if(L&&(R+=o?L:-L),L=0,R+=(k.dummy?s:l)/2,R+=(C.dummy?s:l)/2,R+=C.width/2,e.has(C,"labelpos"))switch(C.labelpos.toLowerCase()){case"l":L=C.width/2;break;case"r":L=-C.width/2;break}return L&&(R+=o?L:-L),L=0,R}}function p(l,s){return l.node(s).width}return ke}var xe,nr;function on(){if(nr)return xe;nr=1;var e=O(),N=U(),q=tn().positionX;xe=b;function b(t){t=N.asNonCompoundGraph(t),d(t),e.forEach(q(t),function(u,r){t.node(r).x=u})}function d(t){var u=N.buildLayerMatrix(t),r=t.graph().ranksep,a=0;e.forEach(u,function(n){var i=e.max(e.map(n,function(m){return t.node(m).height}));e.forEach(n,function(m){t.node(m).y=a+i/2}),a+=i+r})}return xe}var qe,ar;function un(){if(ar)return qe;ar=1;var e=O(),N=Ar(),q=Ur(),b=zr(),d=U().normalizeRanks,t=Yr(),u=U().removeEmptyRanks,r=Wr(),a=Xr(),n=Hr(),i=an(),m=on(),f=U(),E=Y().Graph;qe=I;function I(c,w){var g=w&&w.debugTiming?f.time:f.notime;g("layout",function(){var _=g("  buildLayoutGraph",function(){return R(c)});g("  runLayout",function(){x(_,g)}),g("  updateInputGraph",function(){p(c,_)})})}function x(c,w){w("    makeSpaceForEdgeLabels",function(){L(c)}),w("    removeSelfEdges",function(){sr(c)}),w("    acyclic",function(){N.run(c)}),w("    nestingGraph.run",function(){r.run(c)}),w("    rank",function(){b(f.asNonCompoundGraph(c))}),w("    injectEdgeLabelProxies",function(){S(c)}),w("    removeEmptyRanks",function(){u(c)}),w("    nestingGraph.cleanup",function(){r.cleanup(c)}),w("    normalizeRanks",function(){d(c)}),w("    assignRankMinMax",function(){T(c)}),w("    removeEdgeLabelProxies",function(){G(c)}),w("    normalize.run",function(){q.run(c)}),w("    parentDummyChains",function(){t(c)}),w("    addBorderSegments",function(){a(c)}),w("    order",function(){i(c)}),w("    insertSelfEdges",function(){fr(c)}),w("    adjustCoordinateSystem",function(){n.adjust(c)}),w("    position",function(){m(c)}),w("    positionSelfEdges",function(){cr(c)}),w("    removeBorderNodes",function(){H(c)}),w("    normalize.undo",function(){q.undo(c)}),w("    fixupEdgeLabelCoords",function(){V(c)}),w("    undoCoordinateSystem",function(){n.undo(c)}),w("    translateGraph",function(){B(c)}),w("    assignNodeIntersects",function(){P(c)}),w("    reversePoints",function(){X(c)}),w("    acyclic.undo",function(){N.undo(c)})}function p(c,w){e.forEach(c.nodes(),function(g){var _=c.node(g),M=w.node(g);_&&(_.x=M.x,_.y=M.y,w.children(g).length&&(_.width=M.width,_.height=M.height))}),e.forEach(c.edges(),function(g){var _=c.edge(g),M=w.edge(g);_.points=M.points,e.has(M,"x")&&(_.x=M.x,_.y=M.y)}),c.graph().width=w.graph().width,c.graph().height=w.graph().height}var l=["nodesep","edgesep","ranksep","marginx","marginy"],s={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},o=["acyclicer","ranker","rankdir","align"],h=["width","height"],v={width:0,height:0},y=["minlen","weight","width","height","labeloffset"],k={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},C=["labelpos"];function R(c){var w=new E({multigraph:!0,compound:!0}),g=Z(c.graph());return w.setGraph(e.merge({},s,J(g,l),e.pick(g,o))),e.forEach(c.nodes(),function(_){var M=Z(c.node(_));w.setNode(_,e.defaults(J(M,h),v)),w.setParent(_,c.parent(_))}),e.forEach(c.edges(),function(_){var M=Z(c.edge(_));w.setEdge(_,e.merge({},k,J(M,y),e.pick(M,C)))}),w}function L(c){var w=c.graph();w.ranksep/=2,e.forEach(c.edges(),function(g){var _=c.edge(g);_.minlen*=2,_.labelpos.toLowerCase()!=="c"&&(w.rankdir==="TB"||w.rankdir==="BT"?_.width+=_.labeloffset:_.height+=_.labeloffset)})}function S(c){e.forEach(c.edges(),function(w){var g=c.edge(w);if(g.width&&g.height){var _=c.node(w.v),M=c.node(w.w),D={rank:(M.rank-_.rank)/2+_.rank,e:w};f.addDummyNode(c,"edge-proxy",D,"_ep")}})}function T(c){var w=0;e.forEach(c.nodes(),function(g){var _=c.node(g);_.borderTop&&(_.minRank=c.node(_.borderTop).rank,_.maxRank=c.node(_.borderBottom).rank,w=e.max(w,_.maxRank))}),c.graph().maxRank=w}function G(c){e.forEach(c.nodes(),function(w){var g=c.node(w);g.dummy==="edge-proxy"&&(c.edge(g.e).labelRank=g.rank,c.removeNode(w))})}function B(c){var w=Number.POSITIVE_INFINITY,g=0,_=Number.POSITIVE_INFINITY,M=0,D=c.graph(),F=D.marginx||0,j=D.marginy||0;function Le(z){var A=z.x,W=z.y,Ce=z.width,Ie=z.height;w=Math.min(w,A-Ce/2),g=Math.max(g,A+Ce/2),_=Math.min(_,W-Ie/2),M=Math.max(M,W+Ie/2)}e.forEach(c.nodes(),function(z){Le(c.node(z))}),e.forEach(c.edges(),function(z){var A=c.edge(z);e.has(A,"x")&&Le(A)}),w-=F,_-=j,e.forEach(c.nodes(),function(z){var A=c.node(z);A.x-=w,A.y-=_}),e.forEach(c.edges(),function(z){var A=c.edge(z);e.forEach(A.points,function(W){W.x-=w,W.y-=_}),e.has(A,"x")&&(A.x-=w),e.has(A,"y")&&(A.y-=_)}),D.width=g-w+F,D.height=M-_+j}function P(c){e.forEach(c.edges(),function(w){var g=c.edge(w),_=c.node(w.v),M=c.node(w.w),D,F;g.points?(D=g.points[0],F=g.points[g.points.length-1]):(g.points=[],D=M,F=_),g.points.unshift(f.intersectRect(_,D)),g.points.push(f.intersectRect(M,F))})}function V(c){e.forEach(c.edges(),function(w){var g=c.edge(w);if(e.has(g,"x"))switch((g.labelpos==="l"||g.labelpos==="r")&&(g.width-=g.labeloffset),g.labelpos){case"l":g.x-=g.width/2+g.labeloffset;break;case"r":g.x+=g.width/2+g.labeloffset;break}})}function X(c){e.forEach(c.edges(),function(w){var g=c.edge(w);g.reversed&&g.points.reverse()})}function H(c){e.forEach(c.nodes(),function(w){if(c.children(w).length){var g=c.node(w),_=c.node(g.borderTop),M=c.node(g.borderBottom),D=c.node(e.last(g.borderLeft)),F=c.node(e.last(g.borderRight));g.width=Math.abs(F.x-D.x),g.height=Math.abs(M.y-_.y),g.x=D.x+g.width/2,g.y=_.y+g.height/2}}),e.forEach(c.nodes(),function(w){c.node(w).dummy==="border"&&c.removeNode(w)})}function sr(c){e.forEach(c.edges(),function(w){if(w.v===w.w){var g=c.node(w.v);g.selfEdges||(g.selfEdges=[]),g.selfEdges.push({e:w,label:c.edge(w)}),c.removeEdge(w)}})}function fr(c){var w=f.buildLayerMatrix(c);e.forEach(w,function(g){var _=0;e.forEach(g,function(M,D){var F=c.node(M);F.order=D+_,e.forEach(F.selfEdges,function(j){f.addDummyNode(c,"selfedge",{width:j.label.width,height:j.label.height,rank:F.rank,order:D+ ++_,e:j.e,label:j.label},"_se")}),delete F.selfEdges})})}function cr(c){e.forEach(c.nodes(),function(w){var g=c.node(w);if(g.dummy==="selfedge"){var _=c.node(g.e.v),M=_.x+_.width/2,D=_.y,F=g.x-M,j=_.height/2;c.setEdge(g.e,g.label),c.removeNode(w),g.label.points=[{x:M+2*F/3,y:D-j},{x:M+5*F/6,y:D-j},{x:M+F,y:D},{x:M+5*F/6,y:D+j},{x:M+2*F/3,y:D+j}],g.label.x=g.x,g.label.y=g.y}})}function J(c,w){return e.mapValues(e.pick(c,w),Number)}function Z(c){var w={};return e.forEach(c,function(g,_){w[_.toLowerCase()]=g}),w}return qe}var Re,ir;function dn(){if(ir)return Re;ir=1;var e=O(),N=U(),q=Y().Graph;Re={debugOrdering:b};function b(d){var t=N.buildLayerMatrix(d),u=new q({compound:!0,multigraph:!0}).setGraph({});return e.forEach(d.nodes(),function(r){u.setNode(r,{label:r}),u.setParent(r,"layer"+d.node(r).rank)}),e.forEach(d.edges(),function(r){u.setEdge(r.v,r.w,{},r.name)}),e.forEach(t,function(r,a){var n="layer"+a;u.setNode(n,{rank:"same"}),e.reduce(r,function(i,m){return u.setEdge(i,m,{style:"invis"}),m})}),u}return Re}var _e,tr;function sn(){return tr||(tr=1,_e="0.8.5"),_e}var Ne,or;function hn(){return or||(or=1,Ne={graphlib:Y(),layout:un(),debug:dn(),util:{time:U().time,notime:U().notime},version:sn()}),Ne}export{ur as c,hn as r};
