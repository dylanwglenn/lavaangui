import{d as Cn,w as Te,S as J,i as X,s as Z,c as ee,g as W,o as we,e as B,a as C,b as $e,f as F,l as oe,n as ce,h as I,r as Je,j as Y,k as se,m as x,t as xe,p as V,q as Ie,u as _e,v as Re,x as Xe,y as G,z as j,A as Ze,B as Ke,C as Qe,D,E as A,F as q,G as Ue,H as Ve,I as Sn,J as it,K as lt,L as ae,M as ve,N as ye,O as de}from"./svelte-fdfc2579.js";import{c as H}from"./cytoscape-86e840ae.js";import{g as Ln}from"./cytoscape-grid-guide-eb2f2e88.js";import{e as Mn}from"./cytoscape-edgehandles-455db19b.js";import{v as un}from"./uuid-a960c1f4.js";import{J as Ct}from"./jszip-133f2485.js";import{s as Dn}from"./cytoscape-svg-5a8e6db6.js";import{F as dt}from"./file-saver-05fab67f.js";import{E as An}from"./jspdf-a7c15206.js";import{U as Fn}from"./svg2pdf.js-d0866cf6.js";import{d as In}from"./cytoscape-dagre-a4f19369.js";import{f as On}from"./cytoscape-fcose-2999cda1.js";import{c as Nn}from"./cytoscape-cola-af60e250.js";import{c as Tn}from"./cytoscape-context-menus-cfc05c35.js";import{i as Pn}from"./@jaames-324f80d4.js";import{p as xn}from"./cytoscape-panzoom-81d89c13.js";import{u as Vn}from"./cytoscape-undo-redo-eac3a982.js";import{a as Rn}from"./cytoscape-automove-085c6bfa.js";import{K as cn}from"./konva-bc9c0e16.js";import{n as zn}from"./cytoscape-node-editing-170df28d.js";import{e as Bn}from"./cytoscape-edge-editing-b8b574b0.js";import{D as St}from"./dexie-d2c71554.js";import"./core-js-bbf708ea.js";import"./lodash-6eb5ace2.js";import"./heap-8ffeb77a.js";import"./functional-red-black-tree-9a31655a.js";import"./lodash.memoize-ae7939c9.js";import"./lodash.throttle-e32db46a.js";import"./dagre-9b2543cb.js";import"./graphlib-a6487d85.js";import"./@babel-75df473a.js";import"./fflate-8981c52c.js";import"./cssesc-5de85916.js";import"./font-family-papandreou-066b018a.js";import"./svgpath-76644159.js";import"./specificity-c7128631.js";import"./cose-base-3e61f9ec.js";import"./layout-base-45dab9bc.js";import"./webcola-fe958753.js";import"./jquery-793df3aa.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function i(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(o){if(o.ep)return;o.ep=!0;const s=i(o);fetch(o.href,s)}})();const K=Te(null),_t=Te(null),Le=Te(null);let te=Te({meanStruc:"default",intOvFree:!0,intLvFree:!1,estimator:"default",se:"default",missing:"listwise",n_boot:1e3,fix_first:!0,fix_single:!0,auto_var:!0,auto_cov_lv_x:!0,auto_cov_y:!0,fixed_x:!0,mode:"user model"}),ue=Te({gridShow:!1,gridSpace:26,gridColor:"#dedede",gridWidth:1,gridMovePan:!1,gridSnap:!1,gridAlign:!0,gridResize:!1,showLav:!0,showVar:!0,showMean:!0,std:!1,view:"est",ci:.95,number_digits:2}),Fe=Te({lastFitModel:null,lastFitLavFit:null,lastFitData:null}),R=Te({fitting:!1,loadingMode:!1,runCounter:0,modelEmpty:!0,dataAvail:!1,columnNames:null,loadedFileName:null,ids:null,dragged:null,draggedName:null,full:!0,ready:!1,parsedModel:!1,meansModelled:null,buttonDown:!1,showServerErrors:!0,everEdge:!1,drawing:"none",undoEmpty:!0,redoEmpty:!0,server:!1,shinyapps:!1}),mt=Te(0);Cn(R,n=>n.columnNames);const fn=Te({type:"info",message:"",key:0});function ge(n,e){fn.update(i=>({type:n,message:e,key:i.key+1}))}ge("info","Greetings. lavaangui is BETA software. Please report any bugs at https://github.com/karchjd/lavaangui/issues.");function Un(n,e,i){let t;ee(n,ue,l=>i(1,t=l));let o=!1;Ln(H);let s=W(K);var r={snapToGridOnRelease:!1,drawGrid:!1,snapToAlignmentLocationDuringDrag:!1,distributionGuidelines:!0,geometricGuideline:!0,initPosAlignment:!1,centerToEdgeAlignment:!1,resize:!1,parentPadding:!1,guidelinesStackOrder:4,guidelinesTolerance:2,guidelinesStyle:{strokeStyle:"#8b7d6b",geometricGuidelineRange:2e3,range:100,minDistRange:10,distGuidelineOffset:10,horizontalDistColor:"#ff0000",verticalDistColor:"#00ff00",initPosAlignmentColor:"#0000ff",lineDash:[0,0],horizontalDistLine:[0,0],verticalDistLine:[0,0],initPosAlignmentLine:[0,0]},parentSpacing:-1};return we(()=>{s.gridGuide(r),i(0,o=!0)}),n.$$.update=()=>{n.$$.dirty&3&&o&&t.gridShow!==void 0&&W(K).gridGuide({drawGrid:t.gridShow}),n.$$.dirty&3&&o&&t.gridSpace!==void 0&&W(K).gridGuide({gridSpacing:t.gridSpace}),n.$$.dirty&3&&o&&t.gridWidth!==void 0&&W(K).gridGuide({lineWidth:t.gridWidth}),n.$$.dirty&3&&o&&t.gridMovePan!==void 0&&W(K).gridGuide({panGrid:t.gridMovePan}),n.$$.dirty&3&&o&&t.gridSnap!==void 0&&W(K).gridGuide({snapToGridDuringDrag:t.gridSnap}),n.$$.dirty&3&&o&&t.gridAlign!==void 0&&W(K).gridGuide({snapToAlignmentLocationOnRelease:t.gridAlign}),n.$$.dirty&3&&o&&t.gridResize!==void 0&&W(K).gridGuide({resize:t.gridResize})},[o,t]}class Gn extends J{constructor(e){super(),X(this,e,Un,null,Z,{})}}const le="observed-variable",me="latent-variable",Se="constant",ke="free",He="nolabel",pe="fromUser",ze="label",Pe="byLav",Ee="fixed",De="forcefree",Oe="directed",Ne="undirected",st="loop",Be="linked",Ae="fromLav",Lt="hasEst",ut="validated",We="continous",Ye="ordered",jn="hasEstFixed",qe=80,qn=80,Hn=[{selector:"element",style:{"font-size":function(n){return n.data("font-size")||14}}},{selector:"node",style:{width:qe.toString(),height:"80","background-color":function(n){return n.data("background-color")||"white"},"border-color":function(n){return n.data("border-color")||"grey"},"border-width":function(n){return n.data("border-width")||"2px"},label:"data(label)","text-valign":"center","text-halign":"center"}},{selector:`node.${le}`,style:{shape:"rectangle"}},{selector:`node.${le}.${Ye}`,style:{"border-style":"double","border-width":5}},{selector:`node.${me}`,style:{shape:"ellipse","border-color":"black"}},{selector:`node.${Se}`,style:{shape:"triangle",label:"1","text-valign":"center","text-margin-y":"10px","border-color":"black"}},{selector:`node.${Be}`,style:{"border-color":"black"}},{selector:"edge",style:{width:function(n){return n.data("width")||3},"line-color":function(n){return n.data("line-color")||"#000"},"target-arrow-color":function(n){return n.data("target-arrow-color")||"#000"},"source-arrow-color":function(n){return n.data("source-arrow-color")||"#000"},"target-arrow-shape":"triangle","curve-style":"bezier","text-valign":"center","text-halign":"center","text-wrap":"wrap","text-max-width":qn,"z-index":10,color:"#000","text-outline-color":"#fff","text-outline-width":"2px","text-background-color":"#fff","text-background-opacity":1,"text-background-padding":"4px"}},{selector:"edge.loop",style:{"curve-style":"bezier","source-arrow-shape":"triangle","loop-direction":function(n){return n.data("loop-direction")||0},"loop-sweep":.8,"control-point-step-size":n=>{const e=n.source(),i=parseInt(e.style("height")),t=parseInt(e.style("width"));let o;return n.style("loop-direction")=="0deg"||n.style("loop-direction")=="180deg"?o=i:n.style("loop-direction")=="90deg"||n.style("loop-direction")=="270deg"?o=t:o=Math.max(t,i),o/80*60}}},{selector:`edge.${Ne}`,style:{"curve-style":"unbundled-bezier","control-point-distances":[-100],"control-point-weights":[.5],"source-arrow-shape":"triangle"}},{selector:`edge.${Ne}.${Ae}`,style:{"control-point-distances":[100]}},{selector:`edge.${ze}, edge.${ze}`,style:{label:function(n){return n.data("label")}}},{selector:`edge.${Ee}.${ze}`,style:{label:function(n){return n.data("label")+"@"+n.data("value")}}},{selector:`edge.${Ee}.${He}`,style:{label:function(n){return"@"+n.data("value")}}},{selector:`edge.${De}`,style:{"line-color":"blue"}},{selector:`edge.${Ae}, edge.${Pe}`,style:{"line-style":"dashed"}},{selector:"edge.hidden, node.hidden",style:{display:"none"}},{selector:"edge:selected",style:{"underlay-opacity":.5,"underlay-color":"#928ff8"}},{selector:"node:selected",style:{"underlay-color":"#928ff8","underlay-opacity":.5}}],Yn={autoungrabify:!1,autolock:!1,style:Hn,minZoom:.02,maxZoom:5},Wn={preview:!1,hoverDelay:150,handleNodes:"node",snap:!0,handleColor:"#ff0000",handleSize:10,canConnect:function(n,e){return!cy.edges(function(t){if(!t.isUserAdded())return!1;const o=t.source().id()==n.id()&&t.target().id()==e.id(),s=t.source().id()==e.id()&&t.target().id()==n.id();return o||s}).length}};function Jn(n){H.use(Mn);var e=H(Yn);return e.boxSelectionEnabled(!0),K.set(e),_t.set(e.edgehandles(Wn)),[]}class Xn extends J{constructor(e){super(),X(this,e,Jn,null,Z,{})}}function ie(n){var e=W(R);if(!e.full)return;let i=W(K);const t=i.edges();for(var o=0;o<t.length;o++)t[o].removeEstimates();if(i.getUserEdges().length==0){i.getLavaanNodes().remove(),i.getLavaanEdges().remove(),Shiny.setInputValue("show_help",Math.random());return}if(!e.dataAvail&&n=="estimate"){ge("danger","Model not send to lavaan because no data available");return}let s=mn(n);Shiny.setInputValue("run-fromJavascript",JSON.stringify(s)),Shiny.setInputValue("runCounter",Math.random()),n==="user model"&&i.getLavaanModifiedEdges().forEach(r=>{r.freePara()})}function Zn(n,e){for(let i=0;i<n.length;i++)if(n[i]===e)return!0;return!1}function nt(n,e){let i;n==null?i="1":i=n.getLabel();let t=!1,o;if(e.isFixed()&&!e.isModifiedLavaan()?(o=e.getValue()+"*"+i,t=!0):e.isForceFree()&&(o="NA*"+i,t=!0),e.hasLabel()){const s=e.getLabel();t?o+=" + "+s+"*"+i:(t=!0,o=s+"*"+i)}else t||(o=i);return o}class Kn{constructor(e,i,t=null,o=null,s=null,r=null){this.mode=e,Object.assign(this,{model:{options:t,syntax:o,R_script:i,ordered_labels:r},forceUpdate:Math.random(),cache:s})}}function Mt(n,e="target"){let i="";const t=Math.max(...n.map(l=>l[e]().position().x))-Math.min(...n.map(l=>l[e]().position().x)),o=Math.max(...n.map(l=>l[e]().position().y))-Math.min(...n.map(l=>l[e]().position().y)),s=t>=o?"x":"y",r=n.map((l,d)=>({index:d,value:l.source().position()[s]})).sort((l,d)=>l.value-d.value).map(l=>l.index);for(let l=0;l<n.length;l++){const d=n[r[l]][e]();l>0&&(i+=" + "),i+=nt(d,n[r[l]])}return i}function mn(n){let e=W(K),i=W(R),t="",o="";o+=`library(lavaan)
`,i.dataAvail?o+=`data <- read.csv("${i.loadedFileName}")
`:o+=`#make sure your data is loaded into the 'data' variable
`;let s=e.getLatentNodes();s=s.nodes(function(v){const y=v.connectedEdges(function(E){return E.isDirected()&&E.source().id()==v.id()});return y.length>0&&y.every(E=>E.target().isLatent())});let r=e.getLatentNodes();r=r.nodes(function(v){const y=v.connectedEdges(function(N){return N.isDirected()&&N.target().id()==v.id()}),E=v.connectedEdges(function(N){return N.isDirected()});return E.length>0&&y.length==E.length});let l=e.getLatentNodes(),d=!1;for(let v=0;v<l.length;v++){const y=l[v],E=y.connectedEdges(function(N){return N.isDirected()&&N.source().id()==y.id()&&(N.target().isObserved()||s.some(L=>L.id()===y.id()))});E.length>0&&(d||(t+=`# measurement model
`,d=!0),t+=" "+y.getLabel()+" =~ "+Mt(E,"target")+`
`)}function u(v){return v.isDirected()&&!v.source().isConstant()&&!(v.source().isLatent()&&v.target().isObserved())&&!(v.source().isLatent()&&s.some(E=>E.id()===v.source().id())&&v.target().isLatent())&&(v.isUserAdded()||v.isModifiedLavaan())&&!r.some(E=>E.id()===v.target().id())}let a=e.edges(u),f=[];for(let v=0;v<a.length;v++)Zn(f,a[v].target())||f.push(a[v].target());if(f.length>0){t+=`
# regressions`;for(let v=0;v<f.length;v++){const y=f[v],E=y.connectedEdges(N=>u(N)&&N.target().same(y));if(E.length>0){let N="";for(var g=0;g<E.length;g++){var c=E[g].source();g>0&&(N+=" + "),N+=nt(c,E[g])}t+=`
 `+y.getLabel()+" ~ "+N}}}let m=e.edges(function(v){return(v.isUndirected()||v.myIsLoop())&&(v.isUserAdded()||v.isModifiedLavaan())});if(m.length>0){t+=`

# (residual) (co)variances`;for(let v=0;v<m.length;v++){let y=m[v].source().data("label");t+=`
 `+y+" ~~ "+nt(m[v].target(),m[v])}}const _=e.nodes(function(v){return v.isConstant()});for(let v=0;v<_.length;v++){const E=_[v].connectedEdges(function(N){return N.isUserAdded()});if(E.length>0){t+=`
# intercepts
`;for(var g=0;g<E.length;g++){var c=E[g].target();t+=c.getLabel()+" ~ "+nt(void 0,E[g])+`
`}}}d=!1;for(let v=0;v<r.length;v++){const y=r[v],E=y.connectedEdges(function(N){return N.isDirected()&&N.target().id()==y.id()});E.length>0&&(d||(t+=`

 #  formative factors
`,d=!0),t+=" "+y.getLabel()+" <~ "+Mt(E,"source")+`
`)}t=`'
`+t+`'

`;function p(v,y=60){return v.split(`
`).map(E=>{if(E.includes("+")&&E.length>y){const N=E.split(" + ");let L=[],b=N[0];const w=E.match(/^\s*/)[0],z=b.indexOf("~")+1;for(let ne=1;ne<N.length;ne++)b.length+N[ne].length+3>y?(L.push(b+" + "),b=w+" ".repeat(z)+N[ne]):b+=" + "+N[ne];return L.push(b),L.join(`
`)}return E}).join(`
`)}t=p(t);const S=e.nodes(function(v){return v.isOrdered()}).map(v=>v.getLabel()),h=Qn(S);return o+="model <-"+t,o+="result <- lavaan(model, data, "+h,new Kn(n,o,h,t=t,W(Fe),S)}function Qn(n){const e=W(te),i=Me(e.meanStruc),t=Me(e.intOvFree),o=Me(e.intLvFree);let s=`meanstructure = ${i},
		 int.ov.free = ${t}, int.lv.free = ${o},
		 estimator = ${ct(e.estimator)}, se = ${ct(e.se)},
		 missing = ${ct(e.missing)}, auto.fix.first = ${Me(e.fix_first)},
		 auto.fix.single = ${Me(e.fix_single)}, auto.var = ${Me(e.auto_var)},
		 auto.cov.lv.x = ${Me(e.auto_cov_lv_x)}, auto.cov.y = ${Me(e.auto_cov_y)},
  		 fixed.x = ${Me(e.fixed_x)}`;if(e.se=="boot"){const r=`, bootstrap = ${e.n_boot})`;s=s+r}else s=s+")";return n.length>0&&(s=`ordered = ${'c("'+n.join('", "')+'")'}, ${s}`),s}function ct(n){return'"'+n+'"'}function Me(n){if(n==!0||n=="true")return"TRUE";if(n==!1||n=="false")return"FALSE";if(n=="default")return'"default"';throw new Error("Should not happen")}let gn,pn;function hn(){gn=1,pn=1}hn();function be(n,e,i=!0,t=null){let o=W(K),s=un(),r;if(t!==null){if(o.nodes().find(d=>d.data().label===t)){ge("danger","Node with the same label already exists.");return}r=t}else n==le?r="x"+gn++:n==me?r="f"+pn++:r=void 0,o.nodes().find(d=>d.data().label===r)&&(r=r+".1");let l=W(Le);return e?l.do("add",{group:"nodes",data:{id:s,label:r},classes:[n,We],renderedPosition:e}):(e={x:Math.random()*400+50,y:Math.random()*400+50},o.add({group:"nodes",data:{id:s,label:r},classes:[n,We],renderedPosition:e})),i&&ie(W(te).mode),s}function je(n,e,i=!0,t=!1,o=null,s=!0){let r=W(K),l=un();return r.add({group:"edges",data:{id:l,source:n,target:e,value:t?o:void 0},classes:`${i?Oe:Ne} ${s?pe:Ae} ${t?Ee:ke} ${He}`})}function he(n){const e=so(n);if(e!=null){const i=to(n),t=no(i);let o=io(t);o=eo(o,t),e.data("loop-direction",`${o}deg`)}}function eo(n,e){const i=[0,180,90,270],t=35,o=i.sort((l,d)=>{const u=Math.min(Math.abs(l-n),360-Math.abs(l-n)),a=Math.min(Math.abs(d-n),360-Math.abs(d-n));return u-a}),r=[[0,180],[90,270]].flatMap(l=>o.filter(d=>l.includes(d)));for(const l of r)if(!e.some(u=>{const a=Math.abs(l-u);return Math.min(a,360-a)<=t}))return l;return n}function to(n){const e=cy.getElementById(n);if(e.length===0){console.error(`Node with ID ${n} does not exist.`);return}let i=[];return e.connectedEdges(t=>t.style("display")!=="none").forEach(t=>{const o=t.source(),s=t.target();let r;(o.id()!==e.id()||s.id()!==e.id())&&(o.id()===e.id()?r=Dt(t.sourceEndpoint(),e.position()):r=Dt(t.targetEndpoint(),e.position()),i.push(r))}),i}function Dt(n,e){return Object.keys(n).reduce((i,t)=>{if(e.hasOwnProperty(t))i[t]=n[t]-e[t];else throw new Error(`Key ${t} not found in second object`);return i},{})}function no(n){let e=[];return n.forEach(i=>{e.push(oo(i))}),e}function oo(n){let e=Math.atan2(n.y,n.x)*180/Math.PI;return e=(e+90)%360,e}function io(n){let e=-1,i=null;for(let t=0;t<=360;t++){let o=1/0;for(let s=0;s<n.length;s++){let r=Math.abs(n[s]-t);r=Math.min(r,360-r),o=Math.min(o,r)}o>e&&(e=o,i=t)}return i}function so(n,e){var i=cy.getElementById(n),t=null;return i.connectedEdges().forEach(function(o){var s=o.source(),r=o.target();if(s.id()===n&&r.id()===n){t=o;return}}),t!==null&&i.connectedEdges().length>1&&!t.hasClass("fixDeg")?t:null}function ro(n){let e,i,t;return{c(){e=B("div"),C(e,"id","cy"),C(e,"class","graph svelte-11pj9ut"),$e(e,"flex-basis",n[1].full?"70%":"100%")},m(o,s){F(o,e,s),n[6](e),i||(t=[oe(e,"mouseover",n[2]),oe(e,"mouseout",n[3]),oe(e,"mousemove",n[4]),oe(e,"drop",n[5]),oe(e,"dragover",lo)],i=!0)},p(o,[s]){s&2&&$e(e,"flex-basis",o[1].full?"70%":"100%")},i:ce,o:ce,d(o){o&&I(e),n[6](null),i=!1,Je(t)}}}function lo(n){n.preventDefault()}function ao(n,e){let i=Math.atan2(n,-e)*(180/Math.PI);return i<0&&(i+=360),i}function uo(n,e,i){let t,o,s;ee(n,Le,y=>i(12,t=y)),ee(n,R,y=>i(1,o=y)),ee(n,te,y=>i(13,s=y));let r=W(K),l=W(_t),d,u={x:0,y:0};we(()=>{r.mount(d)});function a(y){if(Y(R,o.buttonDown=!0,o),(y.key==="Alt"||y.key===" "||y.key.toLowerCase()==="x")&&(l.enableDrawMode(),y.key==="Alt"?Y(R,o.drawing="undirected",o):Y(R,o.drawing="directed",o)),y.key==="Backspace"){let E=r.$(":selected");E.length>0&&(t.do("remove",E),ie(s.mode)),Y(R,o.buttonDown=!1,o)}if(["l","o","c"].includes(y.key.toLowerCase())){let E;switch(y.key.toLowerCase()){case"l":E=me;break;case"o":E=le;break;case"c":E=Se;break}be(E,{...u}),Y(R,o.buttonDown=!1,o)}Y(R,o.buttonDown=!1,o)}function f(){r.autoungrabify(!1),r.nodes().grabify()}function g(y){(y.key==="Alt"||y.key===" "||y.key.toLowerCase()==="x")&&(l.disableDrawMode(),Y(R,o.drawing="none",o),f())}function c(){document.addEventListener("keydown",a),document.addEventListener("keyup",g)}function m(){document.removeEventListener("keydown",a,!1),document.removeEventListener("keyup",g,!1)}function _(y){u.x=y.offsetX,u.y=y.offsetY}r.on("ehcomplete",(y,E,N,L)=>{const b=L,w=E.id(),z=N.id();if(b.remove(),b.init(),w!==z?(o.drawing==="undirected"?b.setUndirected():b.setDirected(),he(w),he(z)):(b.makeLoop(),he(z)),!((b.isUndirected()||b.myIsLoop())&&(E.isConstant()||N.isConstant()))&&!(b.isDirected()&&N.isConstant())&&!(b.isDirected()&&E.isConstant()&&N.connectedEdges(O=>O.isUserAdded()&&O.source().isConstant()).length>1)){if(b.myIsLoop()&&E.isOrdered()){ge("error","User-defined variance arrow is not allowed for ordered variables.");return}b.isDirected()&&E.isConstant()?b.makeMeanEdge():b.makeOtherEdge(),t.do("add",b),ie(s.mode)}});function p(y){let E=0;const N=100,L=N*2;y.preventDefault();let b={x:y.offsetX,y:y.offsetY};function w(O,$){let T;if(o.dataAvail){const fe=r.getObservedNodes().map(P=>P.data().label);T=o.columnNames.filter(P=>!fe.includes(P)).map(P=>({text:P,value:P}))}else T=Array.from({length:100},(fe,Q)=>`var${Q+1}`);const U={title:O,inputType:"select",multiple:!0,value:"",inputOptions:T,callback:$};bootbox.prompt(U)}function z(){ge("danger","Either no variable selected or at least one selected variable already is in the model.")}function ne(O){return O&&!r.nodes().some($=>$.data().label===O)}if(o.dragged=="observed-with-name")be(le,b,!0,o.draggedName);else if(o.dragged=="multiple")w("Select Variables",function(O){if(ne(O)){const $=r.zoom();O.forEach(T=>{be(le,{x:b.x+E*$,y:b.y},!0,T),E+=N})}else z()});else if(o.dragged=="factor")w("Select Variables",function(O){if(ne(O)){const $=r.zoom(),T=be(me,{x:b.x+N*$*O.length/2-qe/2*$,y:b.y});O.forEach(U=>{const fe=be(le,{x:b.x+E*$,y:b.y+$*L},!0,U);E+=N,je(T,fe)}),Y(te,s.fix_first=!0,s),Y(te,s.fix_single=!0,s),Y(te,s.auto_var=!0,s),Y(te,s.intOvFree=!0,s),Y(te,s.intLvFree=!1,s)}else z()});else if(o.dragged=="growth"){let O=0;w("Select Time Points",function($){if(ne($)){const T=r.zoom(),U=be(Se,{x:b.x+N*T*$.length/2-qe/2*T,y:b.y},!0),fe=be(me,{x:b.x+qe/2*T,y:b.y+1*L*T},!0,"Intercept"),Q=be(me,{x:b.x+N*T*($.length-1)-qe/2*T,y:b.y+1*L*T},!0,"Slope");je(U,fe,!0,!1),je(U,Q,!0,!1);let P=1;$.forEach(re=>{const Ge=be(le,{x:b.x+O*T,y:b.y+2*L*T},!0,re);O+=N,je(fe,Ge,!0,!0,1),P!=1&&je(Q,Ge,!0,!0,P-1),P+=1}),Y(te,s.auto_var=!0,s),Y(te,s.intOvFree=!1,s),Y(te,s.intLvFree=!0,s)}})}else be(o.dragged,b);(o.dragged=="multiple"||o.dragged=="factor"||o.dragged=="growth")&&ie(s.mode),Y(R,o.dragged=null,o)}let k=!1,S=null,h;r.on("mousedown","edge.loop",function(y){k=!0,S=y.target,S.unpanify(),h=S.style("loop-direction")});let M;r.on("mousemove",function(y){if(!k||!S)return;let N=S.source().renderedPosition();M=ao(u.x-N.x,u.y-N.y);const L=5,b=[0,90,180,270];for(let w=0;w<b.length;w++)if(Math.abs(M-b[w])<=L){M=b[w];break}S.data("loop-direction",`${M}deg`)}),window.addEventListener("mouseup",function(){if(k){if(k=!1,M===void 0||h===`${M}deg`)return;S.data("loop-direction",h),S.addClass("fixDeg"),t.do("style",{eles:S,style:{"loop-direction":`${M}deg`}}),S=null}});function v(y){se[y?"unshift":"push"](()=>{d=y,i(0,d)})}return[d,o,c,m,_,p,v]}class co extends J{constructor(e){super(),X(this,e,uo,ro,Z,{})}}function fo(n,e,i){let t,o;ee(n,R,d=>i(2,t=d)),ee(n,te,d=>i(3,o=d));let s=W(K);s.on("add","node",function(d){const u=d.target;if(u.isObserved()){let a=t.columnNames;a&&a.includes(u.getLabel())&&(u.link(),ge("success",`Variable ${u.getLabel()} linked to data`))}t.modelEmpty&&s.edges().length>0&&Y(R,t.modelEmpty=!1,t)}),s.on("remove","node",function(d){s.getUserEdges().length==0&&(Y(R,t.modelEmpty=!0,t),Shiny.setInputValue("show_help",Math.random())),t.loadingMode||ie(o.mode)}),s.on("remove","edge",function(d){he(d.target.source().id()),he(d.target.target().id())}),s.on("add","edge",function(d){Y(R,t.everEdge=!0,t),t.modelEmpty&&s.edges().length>0&&Y(R,t.modelEmpty=!1,t),he(d.target.source().id()),he(d.target.target().id())}),s.on("position","node",function(d){d.target.neighborhood().nodes().forEach(f=>{const g=f.id();he(g)})});let r=null,l=!1;return s.on("mousedown",function(d){const u=m=>parseFloat(m.replace("px","")),a=d.position;let f=null,g=1/0;const c=30;s.edges().forEach(function(m){if(m.isDirected()){const _=u(m.style("text-margin-x")),p=u(m.style("text-margin-y")),k=m.midpoint(),S={x:k.x+_,y:k.y+p},h=Math.abs(a.x-S.x),M=a.y-S.y,v=Math.sqrt(h*h+M*M);v<g&&v<c&&(f=m,g=v)}}),f!==null&&(r=f,l=!0,d.preventDefault(),f.unpanify())}),s.on("mousemove",function(d){if(l&&r){const u=d.position,a=r.midpoint(),f=r.source().position(),g=r.target().position(),c={x:g.x-f.x,y:g.y-f.y},m=Math.sqrt(c.x**2+c.y**2),_={x:c.x/m,y:c.y/m},p={x:u.x-a.x,y:u.y-a.y};let k=p.x*_.x+p.y*_.y;const S=(g.y-a.y)/_.y-70,h=(f.y-a.y)/_.y+70;let M=Math.min(S,k);M=Math.max(h,M);const v=M*_.x,y=M*_.y;r.style({"text-margin-x":v,"text-margin-y":y})}}),s.on("mouseup",function(d){l=!1,r=null}),[]}class mo extends J{constructor(e){super(),X(this,e,fo,null,Z,{})}}function At(n,e,i){const t=n.slice();return t[21]=e[i],t}function Ft(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_=n[1],p=[];for(let k=0;k<_.length;k+=1)p[k]=It(At(n,_,k));return{c(){e=B("div"),i=x(),t=B("div"),o=B("button"),o.textContent="Multiple Variables",s=x(),r=B("button"),r.textContent="Factor",l=x(),d=B("button"),d.textContent="Growth",u=x(),a=B("div"),f=x(),g=B("ul");for(let k=0;k<p.length;k+=1)p[k].c();C(e,"class","vertical-bar svelte-r00s5r"),C(o,"class","draggable-item svelte-r00s5r"),C(o,"draggable","true"),C(r,"class","draggable-item svelte-r00s5r"),C(r,"draggable","true"),C(d,"class","draggable-item svelte-r00s5r"),C(d,"draggable","true"),C(t,"id","model-buttons"),C(t,"class","svelte-r00s5r"),C(a,"class","vertical-bar svelte-r00s5r"),C(g,"class","draggable-list svelte-r00s5r")},m(k,S){F(k,e,S),F(k,i,S),F(k,t,S),V(t,o),V(t,s),V(t,r),V(t,l),V(t,d),F(k,u,S),F(k,a,S),F(k,f,S),F(k,g,S);for(let h=0;h<p.length;h+=1)p[h]&&p[h].m(g,null);c||(m=[oe(o,"dragstart",n[14]),oe(r,"dragstart",n[15]),oe(d,"dragstart",n[16])],c=!0)},p(k,S){if(S&10){_=k[1];let h;for(h=0;h<_.length;h+=1){const M=At(k,_,h);p[h]?p[h].p(M,S):(p[h]=It(M),p[h].c(),p[h].m(g,null))}for(;h<p.length;h+=1)p[h].d(1);p.length=_.length}},d(k){k&&I(e),k&&I(i),k&&I(t),k&&I(u),k&&I(a),k&&I(f),k&&I(g),Ie(p,k),c=!1,Je(m)}}}function It(n){let e,i=n[21]+"",t,o,s,r;function l(...d){return n[17](n[21],...d)}return{c(){e=B("li"),t=_e(i),o=x(),C(e,"draggable","true"),C(e,"class","draggable-item svelte-r00s5r")},m(d,u){F(d,e,u),V(e,t),V(e,o),s||(r=oe(e,"dragstart",l),s=!0)},p(d,u){n=d,u&2&&i!==(i=n[21]+"")&&Re(t,i)},d(d){d&&I(e),s=!1,r()}}}function go(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_,p=n[0].dataAvail&&Ft(n);return{c(){e=B("div"),i=B("div"),t=B("div"),o=B("button"),s=x(),r=B("button"),l=x(),d=B("div"),u=x(),a=B("div"),f=x(),g=B("div"),c=x(),p&&p.c(),C(o,"class","arrow-btn direct-arrow svelte-r00s5r"),C(o,"title","Draw Directed Arrows"),xe(o,"active",n[0].drawing==="directed"),C(r,"class","arrow-btn undirected-arrow svelte-r00s5r"),C(r,"title","Draw Undirected Arrows"),xe(r,"active",n[0].drawing==="undirected"),C(d,"role","button"),C(d,"id","add-manifest-variable"),C(d,"title","Create Observed Variable"),C(d,"draggable","true"),C(d,"class","variable-button svelte-r00s5r"),C(d,"data-button-type",le),C(d,"tabindex","0"),C(a,"role","button"),C(a,"tabindex","0"),C(a,"id","add-latent-variable"),C(a,"title","Create Latent Variable"),C(a,"draggable","true"),C(a,"class","variable-button svelte-r00s5r"),C(a,"data-button-type",me),C(g,"role","button"),C(g,"tabindex","0"),C(g,"id","add-constant-variable"),C(g,"class","variable-button svelte-r00s5r"),C(g,"title","Create Constant Variable"),C(g,"data-button-type","const"),C(g,"draggable","true"),C(t,"id","buttons"),C(t,"class","svelte-r00s5r"),C(i,"id","buttonCont"),C(i,"class","svelte-r00s5r"),C(e,"class","toolbox svelte-r00s5r")},m(k,S){F(k,e,S),V(e,i),V(i,t),V(t,o),V(t,s),V(t,r),V(t,l),V(t,d),V(t,u),V(t,a),V(t,f),V(t,g),V(e,c),p&&p.m(e,null),m||(_=[oe(o,"click",n[9]),oe(r,"click",n[10]),oe(d,"dragstart",n[11]),oe(a,"dragstart",n[12]),oe(g,"dragstart",n[13])],m=!0)},p(k,[S]){S&1&&xe(o,"active",k[0].drawing==="directed"),S&1&&xe(r,"active",k[0].drawing==="undirected"),k[0].dataAvail?p?p.p(k,S):(p=Ft(k),p.c(),p.m(e,null)):p&&(p.d(1),p=null)},i:ce,o:ce,d(k){k&&I(e),p&&p.d(),m=!1,Je(_)}}}function po(n,e,i){let t,o;ee(n,R,y=>i(0,t=y)),ee(n,K,y=>i(8,o=y)),R.subscribe(y=>{});function s(y){Y(R,t.dragged=y,t)}function r(y,E){Y(R,t.dragged="observed-with-name",t),Y(R,t.draggedName=E,t)}function l(y){Y(R,t.dragged="multiple",t)}function d(y){Y(R,t.dragged="factor",t)}function u(y){Y(R,t.dragged="growth",t)}let a,f=W(_t);function g(y){t.drawing===y?(f.disableDrawMode(),Y(R,t.drawing="none",t)):(f.enableDrawMode(),Y(R,t.drawing=y,t))}const c=()=>{g("directed")},m=()=>{g("undirected")},_=()=>{event.dataTransfer.setData("text/plain","node"),s(le)},p=()=>{s(me)},k=()=>{s(Se)},S=y=>l(),h=y=>d(),M=y=>u(),v=(y,E)=>r(E,y);return n.$$.update=()=>{if(n.$$.dirty&257&&typeof o.getObservedNodes=="function"&&t.columnNames!==null){const y=o.getObservedNodes().map(E=>E.data("label"));i(1,a=t.columnNames.filter(E=>!y.includes(E)))}},[t,a,s,r,l,d,u,g,o,c,m,_,p,k,S,h,M,v]}class ho extends J{constructor(e){super(),X(this,e,po,go,Z,{})}}function bo(n){let e,i,t,o,s;const r=n[1].default,l=Xe(r,n,n[0],null);return o=new ho({}),{c(){e=B("nav"),i=B("ul"),l&&l.c(),t=x(),G(o.$$.fragment),C(i,"class","nav navbar-nav navbar-left"),C(e,"class","navbar navbar-default navbar-static-top navbar-left svelte-12n5yi9")},m(d,u){F(d,e,u),V(e,i),l&&l.m(i,null),V(e,t),j(o,e,null),s=!0},p(d,[u]){l&&l.p&&(!s||u&1)&&Ze(l,r,d,d[0],s?Qe(r,d[0],u,null):Ke(d[0]),null)},i(d){s||(D(l,d),D(o.$$.fragment,d),s=!0)},o(d){A(l,d),A(o.$$.fragment,d),s=!1},d(d){d&&I(e),l&&l.d(d),q(o)}}}function _o(n,e,i){let{$$slots:t={},$$scope:o}=e;return n.$$set=s=>{"$$scope"in s&&i(0,o=s.$$scope)},[o,t]}class $o extends J{constructor(e){super(),X(this,e,_o,bo,Z,{})}}function vo(n){let e,i,t,o,s,r,l;const d=n[3].default,u=Xe(d,n,n[2],null);return{c(){e=B("li"),i=B("a"),t=_e(n[0]),o=B("span"),s=x(),r=B("ul"),u&&u.c(),C(o,"class","caret"),C(i,"href","#"),C(i,"class","dropdown-toggle svelte-1oq006n"),C(i,"data-toggle","dropdown"),C(i,"role","button"),C(i,"aria-haspopup","true"),C(i,"aria-expanded","false"),C(i,"draggable","false"),xe(i,"minimal",n[1]),C(r,"class","dropdown-menu"),C(e,"class","dropdown")},m(a,f){F(a,e,f),V(e,i),V(i,t),V(i,o),V(e,s),V(e,r),u&&u.m(r,null),l=!0},p(a,[f]){(!l||f&1)&&Re(t,a[0]),(!l||f&2)&&xe(i,"minimal",a[1]),u&&u.p&&(!l||f&4)&&Ze(u,d,a,a[2],l?Qe(d,a[2],f,null):Ke(a[2]),null)},i(a){l||(D(u,a),l=!0)},o(a){A(u,a),l=!1},d(a){a&&I(e),u&&u.d(a)}}}function yo(n,e,i){let{$$slots:t={},$$scope:o}=e,{name:s}=e,{minimal:r=!1}=e;return n.$$set=l=>{"name"in l&&i(0,s=l.name),"minimal"in l&&i(1,r=l.minimal),"$$scope"in l&&i(2,o=l.$$scope)},[s,r,o,t]}class et extends J{constructor(e){super(),X(this,e,yo,vo,Z,{name:0,minimal:1})}}function Ot(n,e,i){const t=n.slice();return t[4]=e[i],t}function Nt(n){let e;return{c(){e=B("li"),C(e,"class","divider")},m(i,t){F(i,e,t)},d(i){i&&I(e)}}}function Tt(n){let e,i,t=n[4].name+"",o,s,r,l,d;function u(...f){return n[3](n[4],...f)}let a=n[4].divider&&Nt();return{c(){e=B("li"),i=B("a"),o=_e(t),s=x(),a&&a.c(),r=Ue(),C(i,"href","#"),xe(e,"disabled",n[4].disable)},m(f,g){F(f,e,g),V(e,i),V(i,o),F(f,s,g),a&&a.m(f,g),F(f,r,g),l||(d=oe(i,"click",u),l=!0)},p(f,g){n=f,g&1&&t!==(t=n[4].name+"")&&Re(o,t),g&1&&xe(e,"disabled",n[4].disable),n[4].divider?a||(a=Nt(),a.c(),a.m(r.parentNode,r)):a&&(a.d(1),a=null)},d(f){f&&I(e),f&&I(s),a&&a.d(f),f&&I(r),l=!1,d()}}}function wo(n){let e,i=n[0],t=[];for(let o=0;o<i.length;o+=1)t[o]=Tt(Ot(n,i,o));return{c(){for(let o=0;o<t.length;o+=1)t[o].c();e=Ue()},m(o,s){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(o,s);F(o,e,s)},p(o,s){if(s&1){i=o[0];let r;for(r=0;r<i.length;r+=1){const l=Ot(o,i,r);t[r]?t[r].p(l,s):(t[r]=Tt(l),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=i.length}},d(o){Ie(t,o),o&&I(e)}}}function ko(n){let e,i;return e=new et({props:{minimal:n[2],name:n[1],$$slots:{default:[wo]},$$scope:{ctx:n}}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&4&&(s.minimal=t[2]),o&2&&(s.name=t[1]),o&129&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function Eo(n,e){e.disable||e.action(n)}function Co(n,e,i){let{menuItems:t}=e,{name:o}=e,{minimal:s=!1}=e;const r=(l,d)=>Eo(d,l);return n.$$set=l=>{"menuItems"in l&&i(0,t=l.menuItems),"name"in l&&i(1,o=l.name),"minimal"in l&&i(2,s=l.minimal)},[t,o,s,r]}class at extends J{constructor(e){super(),X(this,e,Co,ko,Z,{menuItems:0,name:1,minimal:2})}}function gt(n,e){if(n==null)throw new Error("Columnnames may not be null.");const t=W(K).nodes(function(s){return s.isObserved()});if(t.length>0)for(var o=0;o<t.length;o++){const s=t[o],r=s.getLabel();n.includes(r)&&!s.isLinked()?s.link():!n.includes(r)&&s.isLinked()&&s.unlink()}}async function bn(n){Shiny.setInputValue("down-requestData",{goal:n,random:Math.random()})}function pt(){W(K).elements().remove(),hn(),R.update(e=>(e.parsedModel=!1,e)),te.update(e=>(e.fix_first=!0,e.mode="user model",e)),Shiny.setInputValue("show_help",Math.random()),Fe.update(e=>{for(let i in e)e[i]=null;return e})}function ht(n){pt();let e=JSON.parse(n),i=W(K),t;t=JSON.parse(e.model);const o=JSON.parse(e.modelOpt),s=JSON.parse(e.gridViewOpt);if(Pt(te,o),Pt(te,s),e.fitCache!==void 0){const r=JSON.parse(e.fitCache);Fe.set(r)}R.update(r=>(r.loadingMode=!0,r)),i.json({elements:t}),i.nodes().forEach(r=>{r.style({width:r.data("width")}),r.style({height:r.data("height")})}),W(R).dataAvail&&gt(W(R).columnNames),W(te).mode!=="user model"?ue.update(r=>(r.showLav=!0,r)):ue.update(r=>(r.showLav=!1,r)),i.nodes().forEach(r=>{he(r.id())}),R.update(r=>(r.loadingMode=!1,r))}function bt(){const n=W(K);n.nodes().forEach(l=>{l.data("width",l.width()),l.data("height",l.height())});let e=n.json().elements;e.nodes.forEach(l=>{l.classes=l.classes.split(" ").filter(d=>d!==Be).join(" ")});const i=JSON.stringify(e),t=JSON.stringify(W(te)),o=JSON.stringify(W(te)),s=JSON.stringify(W(Fe));return JSON.stringify({model:i,modelOpt:t,gridViewOpt:o,fitCache:s})}function Pt(n,e){n.update(i=>{for(let t in e)e.hasOwnProperty(t)&&e[t]!==void 0&&(i[t]=e[t]);return i})}function So(n){let e,i;return e=new at({props:{name:"File",menuItems:n[1],minimal:!n[0]}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&2&&(s.menuItems=t[1]),o&1&&(s.minimal=!t[0]),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function Lo(){document.getElementById("dataUpload-fileInput").click()}function xt(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}_${String(n.getHours()).padStart(2,"0")}-${String(n.getMinutes()).padStart(2,"0")}-${String(n.getSeconds()).padStart(2,"0")}`}function Mo(n,e,i){let t,o;ee(n,R,v=>i(2,t=v)),ee(n,mt,v=>i(3,o=v));let{full:s=!0}=e;H.use(Dn);function r(){t.modelEmpty?pt():bootbox.confirm("Are you sure you want to create a new model? This will delete the current model.",function(v){v&&pt()})}function l(v,y){dt.saveAs(v,"model."+y)}async function d(){const v=document.createElement("input");v.setAttribute("type","file"),v.setAttribute("accept",".lvm");const y=await new Promise(N=>{v.addEventListener("change",L=>N(L.target.files[0])),v.click()}),E=await new Promise(N=>{const L=new FileReader;L.readAsText(y,"UTF-8"),L.onload=()=>N(L.result)});ht(E)}function u(){t.modelEmpty?d():bootbox.confirm("Are you sure you want to load a model? This will delete the current model.",function(v){v&&d()})}document.getElementById("dataUpload-fileInput").addEventListener("change",function(){this.files&&this.files.length>0&&window.$("#upload-modal").modal()});function a(){t.modelEmpty?f():bootbox.confirm("Are you sure you want to load model and data? This will delete the current model and data.",function(v){v&&f()})}function f(){const v=document.createElement("input");v.setAttribute("type","file"),v.setAttribute("accept",".lvd"),v.addEventListener("change",function(y){const E=y.target.files[0],N=new FileReader;N.readAsArrayBuffer(E),N.onload=function(){const L=N.result;Ct.loadAsync(L).then(function(b){b.file("data.csv").async("base64").then(function(w){Shiny.setInputValue("dataUpload-fileInput",{content:w});const z=setInterval(()=>{t.dataAvail&&(clearInterval(z),b.file("model.lvm").async("text").then(function(ne){ht(ne)}))},100)})})}}),v.click()}function g(){const v=bt();let y=new Blob([v],{type:"application/json;charset=utf-8"});dt.saveAs(y,"model_"+xt()+".lvm")}Shiny.addCustomMessageHandler("dataForDownload",function(v){(async()=>{const y=bt(),E=new Ct;E.file("model.lvm",y),E.file("data.csv",v);const N=await E.generateAsync({type:"blob"}),L=new File([N],"model_"+xt()+".lvd",{type:"application/zip"});dt.saveAs(L)})()});function c(){const v=W(K);Y(R,t.dataAvail=!1,t),Y(R,t.columnNames=null,t),Y(R,t.loadedFileName=null,t),Y(R,t.ids=null,t),Y(mt,o=null,o),v.nodes().unlink(),Shiny.setInputValue("dataUpload-deleteData",Math.random())}function m(){const v=W(K);l(v.png({bg:"white"}),"png")}function _(){const v=W(K);l(v.jpg(),"jpg")}function p(){return W(K).svg({scale:1,full:!0})}function k(){const v=p(),y=new Blob([v],{type:"image/svg+xml;charset=utf-8"});l(y,"svg")}function S(){bn("download")}async function h(){const v=p(),E=new DOMParser().parseFromString(v,"image/svg+xml").documentElement;E.style.position="absolute",E.style.left="-9999px",document.body.appendChild(E);const N=E.getBoundingClientRect();document.body.removeChild(E);const L=N.width,b=N.height,w=new An({orientation:L>b?"landscape":"portrait",unit:"pt",format:[L,b]});await Fn(E,w,{width:L,height:b}),w.save("model.pdf")}let M;return n.$$set=v=>{"full"in v&&i(0,s=v.full)},n.$$.update=()=>{if(n.$$.dirty&5){let v=[{name:"New Model",action:r},{name:"Load Model",action:u},{name:"Load Data",action:Lo},{name:"Load Model and Data",action:a},{name:"Download Model",action:g,disable:t.modelEmpty},{name:"Remove Data",action:c,disable:!t.dataAvail},{name:"Download Model and Data",disable:t.modelEmpty||!t.dataAvail,action:S,divider:!0},{name:"Export Diagram to PNG",disable:t.modelEmpty,action:m},{name:"Export Diagram to JPG",disable:t.modelEmpty,action:_},{name:"Export Diagram to SVG",disable:t.modelEmpty,action:k},{name:"Export Diagram to PDF",disable:t.modelEmpty,action:h}];s?i(1,M=v):i(1,M=v.filter(y=>["Download Model","Load Model"].includes(y.name)||v.indexOf(y)>=v.length-4))}},[s,M,t]}class _n extends J{constructor(e){super(),X(this,e,Mo,So,Z,{full:0})}}function Do(n){let e;return{c(){e=B("span"),C(e,"class","glyphicon glyphicon-ok check-mark invisible"),C(e,"aria-hidden","true")},m(i,t){F(i,e,t)},d(i){i&&I(e)}}}function Ao(n){let e;return{c(){e=B("span"),C(e,"class","glyphicon glyphicon-ok check-mark"),C(e,"aria-hidden","true")},m(i,t){F(i,e,t)},d(i){i&&I(e)}}}function Fo(n){let e,i,t,o,s,r,l,d,u;function a(c,m){return c[0]?Ao:Do}let f=a(n),g=f(n);return{c(){e=B("li"),i=B("label"),t=B("input"),o=x(),g.c(),s=x(),r=_e(n[1]),C(t,"type","checkbox"),C(t,"class","check-box svelte-17cge7g"),t.disabled=n[2],C(i,"class",l=Ve(n[2]?"disabled-label":"")+" svelte-17cge7g"),C(e,"class","svelte-17cge7g")},m(c,m){F(c,e,m),V(e,i),V(i,t),t.checked=n[0],V(i,o),g.m(i,null),V(i,s),V(i,r),d||(u=oe(t,"change",n[3]),d=!0)},p(c,[m]){m&4&&(t.disabled=c[2]),m&1&&(t.checked=c[0]),f!==(f=a(c))&&(g.d(1),g=f(c),g&&(g.c(),g.m(i,s))),m&2&&Re(r,c[1]),m&4&&l!==(l=Ve(c[2]?"disabled-label":"")+" svelte-17cge7g")&&C(i,"class",l)},i:ce,o:ce,d(c){c&&I(e),g.d(),d=!1,u()}}}function Io(n,e,i){let{name:t}=e,{checked:o}=e,{disable:s=!1}=e;function r(){o=this.checked,i(0,o)}return n.$$set=l=>{"name"in l&&i(1,t=l.name),"checked"in l&&i(0,o=l.checked),"disable"in l&&i(2,s=l.disable)},[o,t,s,r]}class Ce extends J{constructor(e){super(),X(this,e,Io,Fo,Z,{name:1,checked:0,disable:2})}}function Oo(n){let e;return{c(){e=B("span"),C(e,"class","glyphicon glyphicon-ok check-mark invisible"),C(e,"aria-hidden","true")},m(i,t){F(i,e,t)},d(i){i&&I(e)}}}function No(n){let e;return{c(){e=B("span"),C(e,"class","glyphicon glyphicon-ok check-mark"),C(e,"aria-hidden","true")},m(i,t){F(i,e,t)},d(i){i&&I(e)}}}function To(n){let e,i,t,o=!1,s,r,l,d,u,a,f,g;function c(p,k){return p[0]===p[2]?No:Oo}let m=c(n),_=m(n);return a=Sn(n[5][0]),{c(){e=B("div"),i=B("label"),t=B("input"),s=x(),_.c(),r=x(),l=_e(n[1]),C(t,"type","radio"),C(t,"name","meanStruc"),t.__value=n[2],t.value=t.__value,t.disabled=n[3],C(t,"class","svelte-lbhkwe"),C(i,"class",d=Ve(n[3]?"text-muted":"")+" svelte-lbhkwe"),C(e,"class",u=Ve(n[3]?"radio disabled":"radio")+" svelte-lbhkwe"),a.p(t)},m(p,k){F(p,e,k),V(e,i),V(i,t),t.checked=t.__value===n[0],V(i,s),_.m(i,null),V(i,r),V(i,l),f||(g=oe(t,"change",n[4]),f=!0)},p(p,[k]){k&4&&(t.__value=p[2],t.value=t.__value,o=!0),k&8&&(t.disabled=p[3]),(o||k&1)&&(t.checked=t.__value===p[0]),m!==(m=c(p))&&(_.d(1),_=m(p),_&&(_.c(),_.m(i,r))),k&2&&Re(l,p[1]),k&8&&d!==(d=Ve(p[3]?"text-muted":"")+" svelte-lbhkwe")&&C(i,"class",d),k&8&&u!==(u=Ve(p[3]?"radio disabled":"radio")+" svelte-lbhkwe")&&C(e,"class",u)},i:ce,o:ce,d(p){p&&I(e),_.d(),a.r(),f=!1,g()}}}function Po(n,e,i){let{name:t}=e,{value:o}=e,{group:s}=e,{isDisabled:r=!1}=e;const l=[[]];function d(){s=this.__value,i(0,s)}return n.$$set=u=>{"name"in u&&i(1,t=u.name),"value"in u&&i(2,o=u.value),"group"in u&&i(0,s=u.group),"isDisabled"in u&&i(3,r=u.isDisabled)},[s,t,o,r,d,l]}class tt extends J{constructor(e){super(),X(this,e,Po,To,Z,{name:1,value:2,group:0,isDisabled:3})}}const Vt=[{name:"Arrows Created by Lavaan",modelSlot:"showLav"},{name:"Variance Arrows",modelSlot:"showVar"},{name:"Mean Arrows",modelSlot:"showMean"}];let Rt=[{name:"Estimate",value:"est"},{name:"Confidence Interval",value:"ci"},{name:"Estimate + p-value (stars)",value:"estPVal"},{name:"Estimate + Standard Error",value:"estSE"}];function xo(n,e,i){const t=W(K),o=e?"_std":"",s=$n(n,o,i);t.style().selector("edge.hasEst").style({label:s}).update();const r=zo(n,o,i);t.style().selector("edge.hasEst.label").style({label:r}).update();const l=Bo(n,o,i);t.style().selector("edge.hasEstFixed").style({label:l}).update()}function Vo(n,e,i){function t(a){return a.reduce((f,g,c)=>(g&&f.push(c),f),[])}const o=W(K),s=[e,n,i],r=t(s),l=t(s.map(a=>!a)),d=r.concat(l);function u(a,f){return[c=>c.isLavaanAdded(),c=>c.isLoop(),c=>c.isMean()][a](f)}for(let a of d){const f=o.elements(function(g){return u(a,g)});if(s[a]?f.removeClass("hidden"):f.addClass("hidden"),a==2){const g=f.connectedEdges().connectedNodes(),c=f.connectedEdges();s[a]?c.forEach(m=>{m.removeClass("hidden")}):c.forEach(m=>{m.addClass("hidden")}),g.forEach(m=>{he(m.id())})}else f.forEach(g=>{he(g.source().id()),he(g.target().id())})}}function Ro(n){return n===null?"NA":n<.001?"***":n<.01?"**":n<.05?"*":""}function $n(n,e,i){const t=o=>o===null?"NA":o.toFixed(i);switch(n){case"est":return o=>t(o.data("estimates")["est"+e]);case"ci":return o=>`[${t(o.data("estimates")["ciLow"+e])}, ${t(o.data("estimates")["ciHigh"+e])}]`;case"estPVal":return o=>`${t(o.data("estimates")["est"+e])}${Ro(o.data("estimates").p_value)}`;case"estSE":return o=>`${t(o.data("estimates")["est"+e])} (${t(o.data("estimates")["se"+e])})`;default:return()=>"NA"}}function zo(n,e,i){const t=$n(n,e,i);return o=>`${o.data("label")} = ${t(o)}`}function Bo(n,e,i){const t=o=>o===null?"NA":o.toFixed(i);return o=>"@"+t(o.data("estimates")["estFixed"+e])}function Uo(n){let e,i,t,o,s,r;return{c(){e=B("li"),i=_e(n[1]),t=x(),o=B("input"),$e(o,"width","4em"),C(o,"type","number"),C(o,"min",n[2]),$e(e,"padding-left","28px")},m(l,d){F(l,e,d),V(e,i),V(e,t),V(e,o),it(o,n[0]),s||(r=oe(o,"input",n[3]),s=!0)},p(l,[d]){d&2&&Re(i,l[1]),d&4&&C(o,"min",l[2]),d&1&&lt(o.value)!==l[0]&&it(o,l[0])},i:ce,o:ce,d(l){l&&I(e),s=!1,r()}}}function Go(n,e,i){let{name:t}=e,{value:o}=e,{min:s}=e;function r(){o=lt(this.value),i(0,o)}return n.$$set=l=>{"name"in l&&i(1,t=l.name),"value"in l&&i(0,o=l.value),"min"in l&&i(2,s=l.min)},[o,t,s,r]}class rt extends J{constructor(e){super(),X(this,e,Go,Uo,Z,{name:1,value:0,min:2})}}function zt(n,e,i){const t=n.slice();return t[9]=e[i],t}function Bt(n,e,i){const t=n.slice();return t[9]=e[i],t[12]=e,t[13]=i,t}function Ut(n){let e,i,t,o;function s(d){n[3](d,n[9])}function r(d){n[4](d,n[9])}let l={disable:!1};return n[9].name!==void 0&&(l.name=n[9].name),n[1][n[9].modelSlot]!==void 0&&(l.checked=n[1][n[9].modelSlot]),e=new Ce({props:l}),se.push(()=>ae(e,"name",s)),se.push(()=>ae(e,"checked",r)),{c(){G(e.$$.fragment)},m(d,u){j(e,d,u),o=!0},p(d,u){n=d;const a={};!i&&u&4&&(i=!0,a.name=n[9].name,de(()=>i=!1)),!t&&u&6&&(t=!0,a.checked=n[1][n[9].modelSlot],de(()=>t=!1)),e.$set(a)},i(d){o||(D(e.$$.fragment,d),o=!0)},o(d){A(e.$$.fragment,d),o=!1},d(d){q(e,d)}}}function Gt(n){let e,i,t;function o(r){n[6](r)}let s={name:n[9].name,value:n[9].value};return n[1].view!==void 0&&(s.group=n[1].view),e=new tt({props:s}),se.push(()=>ae(e,"group",o)),{c(){G(e.$$.fragment)},m(r,l){j(e,r,l),t=!0},p(r,l){const d={};!i&&l&2&&(i=!0,d.group=r[1].view,de(()=>i=!1)),e.$set(d)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function jo(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_,p,k,S,h,M,v=n[2],y=[];for(let $=0;$<v.length;$+=1)y[$]=Ut(Bt(n,v,$));const E=$=>A(y[$],1,1,()=>{y[$]=null});function N($){n[5]($)}let L={name:"Standardized Estimates",disable:!1};n[1].std!==void 0&&(L.checked=n[1].std),o=new Ce({props:L}),se.push(()=>ae(o,"checked",N));let b=Rt,w=[];for(let $=0;$<b.length;$+=1)w[$]=Gt(zt(n,b,$));const z=$=>A(w[$],1,1,()=>{w[$]=null});function ne($){n[8]($)}let O={name:"Number Digits",min:0};return n[1].number_digits!==void 0&&(O.value=n[1].number_digits),p=new rt({props:O}),se.push(()=>ae(p,"value",ne)),{c(){for(let $=0;$<y.length;$+=1)y[$].c();e=x(),i=B("li"),t=x(),G(o.$$.fragment),r=x(),l=B("li"),d=x();for(let $=0;$<w.length;$+=1)w[$].c();u=x(),a=B("li"),f=x(),g=B("li"),c=_e(`Confidence Level
    `),m=B("input"),_=x(),G(p.$$.fragment),C(i,"class","divider"),C(l,"class","divider"),C(a,"class","divider"),C(m,"type","number"),C(m,"min","0"),C(m,"max","0.999999"),C(m,"step","0.01"),$e(m,"width","4em"),$e(g,"padding-left","28px")},m($,T){for(let U=0;U<y.length;U+=1)y[U]&&y[U].m($,T);F($,e,T),F($,i,T),F($,t,T),j(o,$,T),F($,r,T),F($,l,T),F($,d,T);for(let U=0;U<w.length;U+=1)w[U]&&w[U].m($,T);F($,u,T),F($,a,T),F($,f,T),F($,g,T),V(g,c),V(g,m),it(m,n[1].ci),F($,_,T),j(p,$,T),S=!0,h||(M=oe(m,"input",n[7]),h=!0)},p($,T){if(T&6){v=$[2];let Q;for(Q=0;Q<v.length;Q+=1){const P=Bt($,v,Q);y[Q]?(y[Q].p(P,T),D(y[Q],1)):(y[Q]=Ut(P),y[Q].c(),D(y[Q],1),y[Q].m(e.parentNode,e))}for(ve(),Q=v.length;Q<y.length;Q+=1)E(Q);ye()}const U={};if(!s&&T&2&&(s=!0,U.checked=$[1].std,de(()=>s=!1)),o.$set(U),T&2){b=Rt;let Q;for(Q=0;Q<b.length;Q+=1){const P=zt($,b,Q);w[Q]?(w[Q].p(P,T),D(w[Q],1)):(w[Q]=Gt(P),w[Q].c(),D(w[Q],1),w[Q].m(u.parentNode,u))}for(ve(),Q=b.length;Q<w.length;Q+=1)z(Q);ye()}T&2&&lt(m.value)!==$[1].ci&&it(m,$[1].ci);const fe={};!k&&T&2&&(k=!0,fe.value=$[1].number_digits,de(()=>k=!1)),p.$set(fe)},i($){if(!S){for(let T=0;T<v.length;T+=1)D(y[T]);D(o.$$.fragment,$);for(let T=0;T<b.length;T+=1)D(w[T]);D(p.$$.fragment,$),S=!0}},o($){y=y.filter(Boolean);for(let T=0;T<y.length;T+=1)A(y[T]);A(o.$$.fragment,$),w=w.filter(Boolean);for(let T=0;T<w.length;T+=1)A(w[T]);A(p.$$.fragment,$),S=!1},d($){Ie(y,$),$&&I(e),$&&I(i),$&&I(t),q(o,$),$&&I(r),$&&I(l),$&&I(d),Ie(w,$),$&&I(u),$&&I(a),$&&I(f),$&&I(g),$&&I(_),q(p,$),h=!1,M()}}}function qo(n){let e,i;return e=new et({props:{name:"View",minimal:n[0],$$slots:{default:[jo]},$$scope:{ctx:n}}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&1&&(s.minimal=t[0]),o&16390&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function Ho(n,e,i){let t;ee(n,ue,f=>i(1,t=f));let{minimal:o=!1}=e;function s(f,g){n.$$.not_equal(g.name,f)&&(g.name=f,i(2,Vt))}function r(f,g){n.$$.not_equal(t[g.modelSlot],f)&&(t[g.modelSlot]=f,ue.set(t))}function l(f){n.$$.not_equal(t.std,f)&&(t.std=f,ue.set(t))}function d(f){n.$$.not_equal(t.view,f)&&(t.view=f,ue.set(t))}function u(){t.ci=lt(this.value),ue.set(t)}function a(f){n.$$.not_equal(t.number_digits,f)&&(t.number_digits=f,ue.set(t))}return n.$$set=f=>{"minimal"in f&&i(0,o=f.minimal)},n.$$.update=()=>{n.$$.dirty&2&&Shiny.setInputValue("ests-confindence_level",t.ci)},[o,t,Vt,s,r,l,d,u,a]}class vn extends J{constructor(e){super(),X(this,e,Ho,qo,Z,{minimal:0})}}function jt(n,e,i){const t=n.slice();return t[9]=e[i],t}function qt(n,e,i){const t=n.slice();return t[9]=e[i],t}function Ht(n,e,i){const t=n.slice();return t[9]=e[i],t}function Yt(n){let e,i,t;function o(r){n[4](r)}let s={name:n[9].name,value:n[9].value};return n[0].estimator!==void 0&&(s.group=n[0].estimator),e=new tt({props:s}),se.push(()=>ae(e,"group",o)),{c(){G(e.$$.fragment)},m(r,l){j(e,r,l),t=!0},p(r,l){const d={};!i&&l&1&&(i=!0,d.group=r[0].estimator,de(()=>i=!1)),e.$set(d)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Wt(n){let e,i,t;function o(r){n[5](r)}let s={name:n[9].name,value:n[9].value};return n[0].se!==void 0&&(s.group=n[0].se),e=new tt({props:s}),se.push(()=>ae(e,"group",o)),{c(){G(e.$$.fragment)},m(r,l){j(e,r,l),t=!0},p(r,l){const d={};!i&&l&1&&(i=!0,d.group=r[0].se,de(()=>i=!1)),e.$set(d)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Jt(n){let e,i,t;function o(r){n[7](r)}let s={name:n[9].name,value:n[9].value};return n[0].missing!==void 0&&(s.group=n[0].missing),e=new tt({props:s}),se.push(()=>ae(e,"group",o)),{c(){G(e.$$.fragment)},m(r,l){j(e,r,l),t=!0},p(r,l){const d={};!i&&l&1&&(i=!0,d.group=r[0].missing,de(()=>i=!1)),e.$set(d)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Yo(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_,p,k,S,h=n[1],M=[];for(let O=0;O<h.length;O+=1)M[O]=Yt(Ht(n,h,O));const v=O=>A(M[O],1,1,()=>{M[O]=null});let y=n[2],E=[];for(let O=0;O<y.length;O+=1)E[O]=Wt(qt(n,y,O));const N=O=>A(E[O],1,1,()=>{E[O]=null});function L(O){n[6](O)}let b={name:"Number of Bootstrap Samples:",min:5};n[0].n_boot!==void 0&&(b.value=n[0].n_boot),f=new rt({props:b}),se.push(()=>ae(f,"value",L));let w=n[3],z=[];for(let O=0;O<w.length;O+=1)z[O]=Jt(jt(n,w,O));const ne=O=>A(z[O],1,1,()=>{z[O]=null});return{c(){e=B("li"),i=B("a"),i.textContent="Estimator",t=x(),o=B("ul");for(let O=0;O<M.length;O+=1)M[O].c();s=x(),r=B("li"),l=B("a"),l.textContent="Standard Error",d=x(),u=B("ul");for(let O=0;O<E.length;O+=1)E[O].c();a=x(),G(f.$$.fragment),c=x(),m=B("li"),_=B("a"),_.textContent="Missing Values",p=x(),k=B("ul");for(let O=0;O<z.length;O+=1)z[O].c();C(i,"tabindex","-1"),C(i,"href","#"),C(i,"class","svelte-143y7r6"),C(o,"class","dropdown-menu svelte-143y7r6"),C(e,"class","dropdown-submenu svelte-143y7r6"),C(l,"tabindex","-1"),C(l,"href","#"),C(l,"class","svelte-143y7r6"),C(u,"class","dropdown-menu svelte-143y7r6"),C(r,"class","dropdown-submenu svelte-143y7r6"),C(_,"tabindex","-1"),C(_,"href","#"),C(_,"class","svelte-143y7r6"),C(k,"class","dropdown-menu svelte-143y7r6"),C(m,"class","dropdown-submenu svelte-143y7r6")},m(O,$){F(O,e,$),V(e,i),V(e,t),V(e,o);for(let T=0;T<M.length;T+=1)M[T]&&M[T].m(o,null);F(O,s,$),F(O,r,$),V(r,l),V(r,d),V(r,u);for(let T=0;T<E.length;T+=1)E[T]&&E[T].m(u,null);V(u,a),j(f,u,null),F(O,c,$),F(O,m,$),V(m,_),V(m,p),V(m,k);for(let T=0;T<z.length;T+=1)z[T]&&z[T].m(k,null);S=!0},p(O,$){if($&3){h=O[1];let U;for(U=0;U<h.length;U+=1){const fe=Ht(O,h,U);M[U]?(M[U].p(fe,$),D(M[U],1)):(M[U]=Yt(fe),M[U].c(),D(M[U],1),M[U].m(o,null))}for(ve(),U=h.length;U<M.length;U+=1)v(U);ye()}if($&5){y=O[2];let U;for(U=0;U<y.length;U+=1){const fe=qt(O,y,U);E[U]?(E[U].p(fe,$),D(E[U],1)):(E[U]=Wt(fe),E[U].c(),D(E[U],1),E[U].m(u,a))}for(ve(),U=y.length;U<E.length;U+=1)N(U);ye()}const T={};if(!g&&$&1&&(g=!0,T.value=O[0].n_boot,de(()=>g=!1)),f.$set(T),$&9){w=O[3];let U;for(U=0;U<w.length;U+=1){const fe=jt(O,w,U);z[U]?(z[U].p(fe,$),D(z[U],1)):(z[U]=Jt(fe),z[U].c(),D(z[U],1),z[U].m(k,null))}for(ve(),U=w.length;U<z.length;U+=1)ne(U);ye()}},i(O){if(!S){for(let $=0;$<h.length;$+=1)D(M[$]);for(let $=0;$<y.length;$+=1)D(E[$]);D(f.$$.fragment,O);for(let $=0;$<w.length;$+=1)D(z[$]);S=!0}},o(O){M=M.filter(Boolean);for(let $=0;$<M.length;$+=1)A(M[$]);E=E.filter(Boolean);for(let $=0;$<E.length;$+=1)A(E[$]);A(f.$$.fragment,O),z=z.filter(Boolean);for(let $=0;$<z.length;$+=1)A(z[$]);S=!1},d(O){O&&I(e),Ie(M,O),O&&I(s),O&&I(r),Ie(E,O),q(f),O&&I(c),O&&I(m),Ie(z,O)}}}function Wo(n){let e,i;return e=new et({props:{name:Jo,$$slots:{default:[Yo]},$$scope:{ctx:n}}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&65537&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}const Jo="Estimation";function Xo(n,e,i){let t;ee(n,te,f=>i(0,t=f));const o=[{value:"default",name:"Default"},{value:"ML",name:"Maximum Likelihood (ML)"},{value:"GLS",name:"Generalized Least Squares (GLS)"},{value:"WLS",name:"Weighted Least Squares (WLS)"},{value:"ULS",name:"Unweighted Least Squares (ULS)"},{value:"DLS",name:"Distributionally-weighted Least Squares (DLW)"}],s=[{value:"default",name:"Default"},{value:"robust",name:"Robust"},{value:"boot",name:"Bootstrap"}],r=[{value:"listwise",name:"Listwise Deletion"},{value:"ml",name:"Full Information Maximum Likelihood (FIML)"}];function l(f){n.$$.not_equal(t.estimator,f)&&(t.estimator=f,te.set(t))}function d(f){n.$$.not_equal(t.se,f)&&(t.se=f,te.set(t))}function u(f){n.$$.not_equal(t.n_boot,f)&&(t.n_boot=f,te.set(t))}function a(f){n.$$.not_equal(t.missing,f)&&(t.missing=f,te.set(t))}return[t,o,s,r,l,d,u,a]}class Zo extends J{constructor(e){super(),X(this,e,Xo,Wo,Z,{})}}let ft=0,yn=!1;function wn(){return typeof Shiny=="object"&&Shiny!==null}function Ko(n){const e=Object.keys(n),i=n[e[0]].length,t=[];for(let o=0;o<i;o++){const s={};for(const r of e)s[r]=n[r][o];t.push(s)}return t}function ot(n,e=!0){yn=e,ft=ft+1;let i=mn(!0);i.name=n,i.counter=ft,wn()&&Shiny.setInputValue("layout-layout",JSON.stringify(i))}wn()&&Shiny.addCustomMessageHandler("semPlotLayout",function(n){n=Ko(n);const e=125,i=200;let t=1/0,o=1/0;for(let u=0;u<n.length;u++)for(let a=u+1;a<n.length;a++){const f=Math.abs(n[u].x-n[a].x),g=Math.abs(n[u].y-n[a].y);f<t&&n[u].y===n[a].y&&(t=f),g<o&&g!==0&&(o=g)}const s=e/t,r=i/o;let l={};n.forEach(u=>{const a=u.x*s+400,f=u.y*-1*r+400;l[u.name]={x:a,y:f}});let d={name:"preset",positions:function(u){const a=u.data("label");return l[a]},fit:!0,padding:60,animate:!0};yn?W(Le).do("layout",{options:d}):W(K).layout(d).run()});function Qo(n){let e,i;return e=new at({props:{name:"Apply Layout",menuItems:n[1],minimal:n[0]}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&2&&(s.menuItems=t[1]),o&1&&(s.minimal=t[0]),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function ei(n,e,i){let t,o,s;ee(n,R,g=>i(2,o=g)),ee(n,Le,g=>i(3,s=g));let{minimal:r=!1}=e;W(K),we(()=>{H.use(In),H.use(On),H.use(Nn)});function l(){const g={name:"dagre",rankSep:150,animate:!0};s.do("layout",{options:g})}function d(){const g={name:"breadthfirst",animate:!0,spacingFactor:1};s.do("layout",{options:g})}function u(){const g={name:"circle",animate:!0};s.do("layout",{options:g})}function a(){const g={name:"fcose",animate:!0,idealEdgeLength:c=>150,quality:"proof",randomize:!1,nodeSeparation:200};s.do("layout",{options:g})}function f(){const g={name:"cola",animate:!0,nodeSpacing(c){return 50}};s.do("layout",{options:g})}return n.$$set=g=>{"minimal"in g&&i(0,r=g.minimal)},n.$$.update=()=>{n.$$.dirty&4&&i(1,t=[{name:"Recommended: Tree",action:()=>ot("tree"),disable:o.modelEmpty},{name:"Recommended: Tree2",action:()=>ot("tree2"),disable:o.modelEmpty},{name:"Recommended: Tree3",action:()=>ot("tree3"),disable:o.modelEmpty},{name:"Experimental: Tree",action:l,disable:o.modelEmpty},{name:"Experimental: Tree2",action:d,disable:o.modelEmpty},{name:"Experimental: Circle",action:u,disable:o.modelEmpty},{name:"Experimental: Force-directed",action:a,disable:o.modelEmpty},{name:"Experimental: Cola",action:f,disable:o.modelEmpty}])},[r,t,o]}class kn extends J{constructor(e){super(),X(this,e,ei,Qo,Z,{minimal:0})}}function Xt(n,e,i){const t=n.slice();return t[11]=e[i],t}function Zt(n,e,i){const t=n.slice();return t[11]=e[i],t[14]=e,t[15]=i,t}function Kt(n){let e,i,t,o;function s(d){n[4](d,n[11])}function r(d){n[5](d,n[11])}let l={};return n[11].name!==void 0&&(l.name=n[11].name),n[0][n[11].modelProperty]!==void 0&&(l.checked=n[0][n[11].modelProperty]),e=new Ce({props:l}),se.push(()=>ae(e,"name",s)),se.push(()=>ae(e,"checked",r)),{c(){G(e.$$.fragment)},m(d,u){j(e,d,u),o=!0},p(d,u){n=d;const a={};!i&&u&2&&(i=!0,a.name=n[11].name,de(()=>i=!1)),!t&&u&3&&(t=!0,a.checked=n[0][n[11].modelProperty],de(()=>t=!1)),e.$set(a)},i(d){o||(D(e.$$.fragment,d),o=!0)},o(d){A(e.$$.fragment,d),o=!1},d(d){q(e,d)}}}function Qt(n){let e,i,t;function o(r){n[6](r)}let s={name:n[11].name,value:n[11].value};return n[0].meanStruc!==void 0&&(s.group=n[0].meanStruc),e=new tt({props:s}),se.push(()=>ae(e,"group",o)),{c(){G(e.$$.fragment)},m(r,l){j(e,r,l),t=!0},p(r,l){const d={};!i&&l&1&&(i=!0,d.group=r[0].meanStruc,de(()=>i=!1)),e.$set(d)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function ti(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_=n[1],p=[];for(let w=0;w<_.length;w+=1)p[w]=Kt(Zt(n,_,w));const k=w=>A(p[w],1,1,()=>{p[w]=null});let S=n[3],h=[];for(let w=0;w<S.length;w+=1)h[w]=Qt(Xt(n,S,w));const M=w=>A(h[w],1,1,()=>{h[w]=null});function v(w){n[7](w)}function y(w){n[8](w)}let E={name:"Add Intercepts for all Observed Variables"};n[0].intOvFree!==void 0&&(E.checked=n[0].intOvFree),n[2]!==void 0&&(E.disable=n[2]),l=new Ce({props:E}),se.push(()=>ae(l,"checked",v)),se.push(()=>ae(l,"disable",y));function N(w){n[9](w)}function L(w){n[10](w)}let b={name:"Add Intercepts for all Latent Variables"};return n[0].intLvFree!==void 0&&(b.checked=n[0].intLvFree),n[2]!==void 0&&(b.disable=n[2]),f=new Ce({props:b}),se.push(()=>ae(f,"checked",N)),se.push(()=>ae(f,"disable",L)),{c(){for(let w=0;w<p.length;w+=1)p[w].c();e=x(),i=B("li"),t=B("a"),t.textContent="Add Means?",o=x(),s=B("ul");for(let w=0;w<h.length;w+=1)h[w].c();r=x(),G(l.$$.fragment),a=x(),G(f.$$.fragment),C(t,"tabindex","-1"),C(t,"href","#"),C(t,"class","svelte-143y7r6"),C(s,"class","dropdown-menu svelte-143y7r6"),C(i,"class","dropdown-submenu svelte-143y7r6")},m(w,z){for(let ne=0;ne<p.length;ne+=1)p[ne]&&p[ne].m(w,z);F(w,e,z),F(w,i,z),V(i,t),V(i,o),V(i,s);for(let ne=0;ne<h.length;ne+=1)h[ne]&&h[ne].m(s,null);F(w,r,z),j(l,w,z),F(w,a,z),j(f,w,z),m=!0},p(w,z){if(z&3){_=w[1];let $;for($=0;$<_.length;$+=1){const T=Zt(w,_,$);p[$]?(p[$].p(T,z),D(p[$],1)):(p[$]=Kt(T),p[$].c(),D(p[$],1),p[$].m(e.parentNode,e))}for(ve(),$=_.length;$<p.length;$+=1)k($);ye()}if(z&9){S=w[3];let $;for($=0;$<S.length;$+=1){const T=Xt(w,S,$);h[$]?(h[$].p(T,z),D(h[$],1)):(h[$]=Qt(T),h[$].c(),D(h[$],1),h[$].m(s,null))}for(ve(),$=S.length;$<h.length;$+=1)M($);ye()}const ne={};!d&&z&1&&(d=!0,ne.checked=w[0].intOvFree,de(()=>d=!1)),!u&&z&4&&(u=!0,ne.disable=w[2],de(()=>u=!1)),l.$set(ne);const O={};!g&&z&1&&(g=!0,O.checked=w[0].intLvFree,de(()=>g=!1)),!c&&z&4&&(c=!0,O.disable=w[2],de(()=>c=!1)),f.$set(O)},i(w){if(!m){for(let z=0;z<_.length;z+=1)D(p[z]);for(let z=0;z<S.length;z+=1)D(h[z]);D(l.$$.fragment,w),D(f.$$.fragment,w),m=!0}},o(w){p=p.filter(Boolean);for(let z=0;z<p.length;z+=1)A(p[z]);h=h.filter(Boolean);for(let z=0;z<h.length;z+=1)A(h[z]);A(l.$$.fragment,w),A(f.$$.fragment,w),m=!1},d(w){Ie(p,w),w&&I(e),w&&I(i),Ie(h,w),w&&I(r),q(l,w),w&&I(a),q(f,w)}}}function ni(n){let e,i;return e=new et({props:{name:oi,$$slots:{default:[ti]},$$scope:{ctx:n}}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&65543&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}const oi="Automatically..";function ii(n,e,i){let t,o;ee(n,te,m=>i(0,o=m));const s=[{name:"Fix Factor Loading of First Indicator at 1",modelProperty:"fix_first"},{name:"Include Variances",modelProperty:"auto_var"},{name:"Include Covariances of Exogenous Latent Variables",modelProperty:"auto_cov_lv_x"},{name:"Include Covariances of Dependent Variables",modelProperty:"auto_cov_y"},{name:"Fix Variance of Only Indicator to 0",modelProperty:"fix_single"},{name:"Treat Exogenous Observed Variables as Fixed Variables",modelProperty:"fixed_x"}];let r=[{name:"Default",value:"default"},{name:"Yes",value:"true"},{name:"No",value:"false"}];function l(m,_){n.$$.not_equal(_.name,m)&&(_.name=m,i(1,s))}function d(m,_){n.$$.not_equal(o[_.modelProperty],m)&&(o[_.modelProperty]=m,te.set(o))}function u(m){n.$$.not_equal(o.meanStruc,m)&&(o.meanStruc=m,te.set(o))}function a(m){n.$$.not_equal(o.intOvFree,m)&&(o.intOvFree=m,te.set(o))}function f(m){t=m,i(2,t),i(0,o)}function g(m){n.$$.not_equal(o.intLvFree,m)&&(o.intLvFree=m,te.set(o))}function c(m){t=m,i(2,t),i(0,o)}return n.$$.update=()=>{n.$$.dirty&1&&i(2,t=o.meanStruc==="false")},[o,s,t,r,l,d,u,a,f,g,c]}class si extends J{constructor(e){super(),X(this,e,ii,ni,Z,{})}}function ri(n){let e,i;return e=new at({props:{name:"Help",menuItems:n[0]}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p:ce,i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function li(){Shiny.setInputValue("show_help",Math.random())}function ai(){window.open("https://doi.org/10.31234/osf.io/f4ary","_blank")}function di(n){let e;const i=[{name:"Show Commands",action:li},{name:"Open Tutorial",action:ai},{name:"About",action:t}];function t(){bootbox.alert({title:"About Lavaangui",message:`Version: ${e}<br> Author: Julian D. Karch<br> Email: j.d.karch@fsw.leidenuniv.nl`})}return Shiny.addCustomMessageHandler("version",function(o){e=o[0].join(".")}),[i]}class ui extends J{constructor(e){super(),X(this,e,di,ri,Z,{})}}function ci(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_,p,k,S,h,M,v;function y(P){n[2](P)}let E={name:"Show Grid"};n[1].gridShow!==void 0&&(E.checked=n[1].gridShow),e=new Ce({props:E}),se.push(()=>ae(e,"checked",y));function N(P){n[3](P)}let L={name:"Snap to Grid"};n[1].gridSnap!==void 0&&(L.checked=n[1].gridSnap),o=new Ce({props:L}),se.push(()=>ae(o,"checked",N));function b(P){n[4](P)}let w={name:"Resize to Grid"};n[1].gridResize!==void 0&&(w.checked=n[1].gridResize),l=new Ce({props:w}),se.push(()=>ae(l,"checked",b));function z(P){n[5](P)}let ne={name:"Snap to Alignment on Release"};n[1].gridAlign!==void 0&&(ne.checked=n[1].gridAlign),a=new Ce({props:ne}),se.push(()=>ae(a,"checked",z));function O(P){n[6](P)}let $={name:"Move Grid on Pan"};n[1].gridMovePan!==void 0&&($.checked=n[1].gridMovePan),c=new Ce({props:$}),se.push(()=>ae(c,"checked",O));function T(P){n[7](P)}let U={name:"Grid Spacing:",min:5};n[1].gridSpace!==void 0&&(U.value=n[1].gridSpace),p=new rt({props:U}),se.push(()=>ae(p,"value",T));function fe(P){n[8](P)}let Q={name:"Line Width:",min:0};return n[1].gridWidth!==void 0&&(Q.value=n[1].gridWidth),h=new rt({props:Q}),se.push(()=>ae(h,"value",fe)),{c(){G(e.$$.fragment),t=x(),G(o.$$.fragment),r=x(),G(l.$$.fragment),u=x(),G(a.$$.fragment),g=x(),G(c.$$.fragment),_=x(),G(p.$$.fragment),S=x(),G(h.$$.fragment)},m(P,re){j(e,P,re),F(P,t,re),j(o,P,re),F(P,r,re),j(l,P,re),F(P,u,re),j(a,P,re),F(P,g,re),j(c,P,re),F(P,_,re),j(p,P,re),F(P,S,re),j(h,P,re),v=!0},p(P,re){const Ge={};!i&&re&2&&(i=!0,Ge.checked=P[1].gridShow,de(()=>i=!1)),e.$set(Ge);const $t={};!s&&re&2&&(s=!0,$t.checked=P[1].gridSnap,de(()=>s=!1)),o.$set($t);const vt={};!d&&re&2&&(d=!0,vt.checked=P[1].gridResize,de(()=>d=!1)),l.$set(vt);const yt={};!f&&re&2&&(f=!0,yt.checked=P[1].gridAlign,de(()=>f=!1)),a.$set(yt);const wt={};!m&&re&2&&(m=!0,wt.checked=P[1].gridMovePan,de(()=>m=!1)),c.$set(wt);const kt={};!k&&re&2&&(k=!0,kt.value=P[1].gridSpace,de(()=>k=!1)),p.$set(kt);const Et={};!M&&re&2&&(M=!0,Et.value=P[1].gridWidth,de(()=>M=!1)),h.$set(Et)},i(P){v||(D(e.$$.fragment,P),D(o.$$.fragment,P),D(l.$$.fragment,P),D(a.$$.fragment,P),D(c.$$.fragment,P),D(p.$$.fragment,P),D(h.$$.fragment,P),v=!0)},o(P){A(e.$$.fragment,P),A(o.$$.fragment,P),A(l.$$.fragment,P),A(a.$$.fragment,P),A(c.$$.fragment,P),A(p.$$.fragment,P),A(h.$$.fragment,P),v=!1},d(P){q(e,P),P&&I(t),q(o,P),P&&I(r),q(l,P),P&&I(u),q(a,P),P&&I(g),q(c,P),P&&I(_),q(p,P),P&&I(S),q(h,P)}}}function fi(n){let e,i;return e=new et({props:{minimal:n[0],name:"Grid Options",$$slots:{default:[ci]},$$scope:{ctx:n}}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&1&&(s.minimal=t[0]),o&514&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function mi(n,e,i){let t;ee(n,ue,g=>i(1,t=g));let{minimal:o=!1}=e;function s(g){n.$$.not_equal(t.gridShow,g)&&(t.gridShow=g,ue.set(t))}function r(g){n.$$.not_equal(t.gridSnap,g)&&(t.gridSnap=g,ue.set(t))}function l(g){n.$$.not_equal(t.gridResize,g)&&(t.gridResize=g,ue.set(t))}function d(g){n.$$.not_equal(t.gridAlign,g)&&(t.gridAlign=g,ue.set(t))}function u(g){n.$$.not_equal(t.gridMovePan,g)&&(t.gridMovePan=g,ue.set(t))}function a(g){n.$$.not_equal(t.gridSpace,g)&&(t.gridSpace=g,ue.set(t))}function f(g){n.$$.not_equal(t.gridWidth,g)&&(t.gridWidth=g,ue.set(t))}return n.$$set=g=>{"minimal"in g&&i(0,o=g.minimal)},[o,t,s,r,l,d,u,a,f]}class En extends J{constructor(e){super(),X(this,e,mi,fi,Z,{minimal:0})}}function gi(n){return window.$(document).ready(function(){var e=!1;window.$(".navbar .dropdown").hover(function(){e&&(window.$(".navbar .dropdown").removeClass("open"),window.$(this).addClass("open"))},function(){}),window.$(".navbar .dropdown").on("show.bs.dropdown",function(){e=!0}),window.$(".navbar .dropdown").on("hide.bs.dropdown",function(){window.$(".navbar .dropdown.open").length<=1&&(e=!1)})}),[]}class pi extends J{constructor(e){super(),X(this,e,gi,null,Z,{})}}function hi(n){let e,i;return e=new at({props:{name:"Edit",menuItems:n[0]}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&1&&(s.menuItems=t[0]),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function bi(n,e,i){let t,o;ee(n,R,d=>i(1,t=d)),ee(n,Le,d=>i(2,o=d));function s(){o.undo()}function r(){o.redo()}let l=[];return n.$$.update=()=>{n.$$.dirty&2&&i(0,l=[{name:"Undo",action:s,disable:t.undoEmpty},{name:"Redo",action:r,disable:t.redoEmpty}])},[l,t]}class _i extends J{constructor(e){super(),X(this,e,bi,hi,Z,{})}}function $i(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_,p,k,S;return e=new _n({}),t=new _i({}),s=new vn({}),l=new si({}),u=new Zo({}),f=new kn({}),c=new En({}),_=new ui({}),k=new pi({}),{c(){G(e.$$.fragment),i=x(),G(t.$$.fragment),o=x(),G(s.$$.fragment),r=x(),G(l.$$.fragment),d=x(),G(u.$$.fragment),a=x(),G(f.$$.fragment),g=x(),G(c.$$.fragment),m=x(),G(_.$$.fragment),p=x(),G(k.$$.fragment)},m(h,M){j(e,h,M),F(h,i,M),j(t,h,M),F(h,o,M),j(s,h,M),F(h,r,M),j(l,h,M),F(h,d,M),j(u,h,M),F(h,a,M),j(f,h,M),F(h,g,M),j(c,h,M),F(h,m,M),j(_,h,M),F(h,p,M),j(k,h,M),S=!0},i(h){S||(D(e.$$.fragment,h),D(t.$$.fragment,h),D(s.$$.fragment,h),D(l.$$.fragment,h),D(u.$$.fragment,h),D(f.$$.fragment,h),D(c.$$.fragment,h),D(_.$$.fragment,h),D(k.$$.fragment,h),S=!0)},o(h){A(e.$$.fragment,h),A(t.$$.fragment,h),A(s.$$.fragment,h),A(l.$$.fragment,h),A(u.$$.fragment,h),A(f.$$.fragment,h),A(c.$$.fragment,h),A(_.$$.fragment,h),A(k.$$.fragment,h),S=!1},d(h){q(e,h),h&&I(i),q(t,h),h&&I(o),q(s,h),h&&I(r),q(l,h),h&&I(d),q(u,h),h&&I(a),q(f,h),h&&I(g),q(c,h),h&&I(m),q(_,h),h&&I(p),q(k,h)}}}function vi(n){let e,i;return e=new $o({props:{$$slots:{default:[$i]},$$scope:{ctx:n}}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}class yi extends J{constructor(e){super(),X(this,e,null,vi,Z,{})}}function wi(n){let e;return{c(){e=B("pre"),C(e,"id","res-results"),C(e,"class","shiny-html-output well svelte-74yvxb"),C(e,"data-testid","result-text")},m(i,t){F(i,e,t)},p:ce,i:ce,o:ce,d(i){i&&I(e)}}}class ki extends J{constructor(e){super(),X(this,e,null,wi,Z,{})}}function Ei(n){return window.cy=W(K),R.subscribe(e=>{window.appState=e}),te.subscribe(e=>{window.modelOptions=e}),mt.subscribe(e=>{window.dataInfo=e}),Fe.subscribe(e=>{window.fitCache=e}),ue.subscribe(e=>{window.gridViewOptions=e}),Le.subscribe(e=>{window.ur=e}),[]}class Ci extends J{constructor(e){super(),X(this,e,Ei,null,Z,{})}}function Si(n){return new RegExp("^[a-zA-Z\\._][a-zA-Z0-9\\._]*(?<!\\.)$").test(n)}function en(n){return n==""?(bootbox.alert("Provide a label"),!1):Si(n)?!0:(bootbox.alert("Provide a valid label"),!1)}function Li(n,e){const i=e?"full":"minimal";return n.filter(t=>t.show===i||t.show==="both")}function Mi(n,e,i){let t,o,s;ee(n,R,c=>i(1,t=c)),ee(n,Le,c=>i(2,o=c)),ee(n,te,c=>i(3,s=c));let r=W(K);H.use(Tn);var l=new Pn.ColorPicker("#picker",{width:200,color:"rgb(255, 0, 0)",borderWidth:1,borderColor:"#fff"});function d(c,m){var _;const p=r.$(":selected");if(p.length>1){if(m==="nodes"&&!p.every(k=>k.isNode()))return bootbox.alert("Not all selected elements are nodes. Aborting"),null;if(m==="edges"&&!p.every(k=>k.isEdge()))return bootbox.alert("Not all selected elements are edges. Aborting"),null;if(m==="nodes.edges"&&!p.every(k=>k.isEdge()||k.isNode()))return bootbox.alert("Not all selected elements are nodes or edges. Aborting"),null;_=p}else _=c;return _}const u=[{id:"add-observed",content:"Add Observed Variable",coreAsWell:!0,onClickFunction(c){const m=c.renderedPosition;be(le,m)},show:"full"},{id:"add-latent",content:"Add Latent Variable",coreAsWell:!0,onClickFunction(c){const m=c.renderedPosition;be(me,m)},show:"full"},{id:"add-constant",content:"Add Constant Variable",coreAsWell:!0,onClickFunction(c){const m=c.renderedPosition;be(Se,m)},show:"full"},{id:"label-para",content:"Add/Change Label",selector:`edge.${pe}`,onClickFunction(c){const m=c.target||c.cyTarget;bootbox.prompt({title:"Enter a Label",value:m.getLabel(),callback(_){if(!en(_))return!1;_!==m.getLabel()&&_!==null&&(m.addLabel(_),ie(s.mode))}})},show:"full",hasTrailingDivider:!1},{id:"label-remove",content:"Remove Label",selector:`edge.${ze}`,onClickFunction(c){(c.target||c.cyTarget).removeLabel(),ie(s.mode)},show:"both",hasTrailingDivider:!1},{id:"remove-edge",content:"Delete Edge",selector:`edge.${pe}`,onClickFunction(c){(c.target||c.cyTarget).remove(),ie(s.mode)},show:"full",hasTrailingDivider:!0},{id:"fix-para",content:"Fix Parameter",selector:`edge.${ke}.${pe}, edge.${De}.${pe}`,onClickFunction(c){const m=c.target||c.cyTarget;bootbox.prompt({title:"Enter a Value",inputType:"number",callback(_){if(_=="")return bootbox.alert("Provide a value"),!1;_!==null&&(m.fixPara(_),ie(s.mode))}})},show:"full",hasTrailingDivider:!1},{id:"free-para",content:"Free Parameter",selector:`edge.${Ee}.${pe}, edge.${De}.${pe}`,onClickFunction(c){var m=c.target||c.cyTarget;m.freePara(),ie(s.mode)},show:"full",hasTrailingDivider:!1},{id:"free-force-para",content:"Force Parameter Free",selector:`edge.${ke}.${pe}, edge.${Ee}.${pe}`,onClickFunction(c){(c.target||c.cyTarget).forceFreePara(),ie(s.mode)},show:"full",hasTrailingDivider:!0},{id:"revert-arrow",content:"Revert Direction",selector:`edge[isMean="0"].${Oe}.${pe}`,onClickFunction(c){(c.target||c.cyTarget).revert(),ie(s.mode)},show:"full",hasTrailingDivider:!1},{id:"set-undirected",content:"Set Undirected",selector:`edge[isMean="0"].${Oe}.${pe}`,onClickFunction(c){(c.target||c.cyTarget).setUndirected(),ie(s.mode)},show:"full",hasTrailingDivider:!0},{id:"set-arrow",content:"Set Directed",selector:`edge.${Ne}.${pe}`,onClickFunction(c){(c.target||c.cyTarget).setDirected(),ie(s.mode)},show:"full",hasTrailingDivider:!0},{id:"free-orientation",content:"Free Loop Orientation",selector:`edge.${st}.fixDeg`,onClickFunction(c){const m=c.target||c.cyTarget;m.removeClass("fixDeg"),he(m.source().id())},show:"both",hasTrailingDivider:!0},{id:"change-fromUser",content:"Include in User Model",selector:`edge.${Ae}`,onClickFunction(c){const m=c.target||c.cyTarget;if(m.myIsLoop()&&m.source().isOrdered()){ge("danger","User-defined variance arrow is not allowed for ordered variables.");return}m.markAddedUser(),ie(s.mode)},show:"full",hasTrailingDivider:!0},{id:"color-edge",content:"Change Edge Color",selector:"edge",show:"both",onClickFunction(c){var m=c.target||c.cyTarget;const _=d(m,"edges");if(_===null)return null;f(m,_,"edge")}},{id:"change-line-width",content:"Change Line Width",show:"both",selector:"edge",onClickFunction(c){var m=c.target||c.cyTarget;const _=d(m,"edges");if(_===null)return null;bootbox.prompt({title:"Enter New Line Width:",value:m.style("width"),callback(p){p!==null&&o.do("style",{eles:_,style:{width:p}})}})}},{id:"rename-node",show:"full",content:"Rename Variable",selector:`node.${me}, node.${le}`,onClickFunction(c){const m=c.target||c.cyTarget,_=t.columnNames;let p;t.dataAvail&&(p=_.map(S=>`<option value="${S}">${S}</option>`).join(""));const k=t.dataAvail&&m.isObserved()?`
      <label>Or Select From Variables in Your Data:</label>
      <select class="form-control" id="label-dropdown">
        <option value="">--Select--</option>
        ${p}
      </select>
    `:"";bootbox.dialog({title:"Rename Variable",message:`
      <div>
        <label>Enter a label:</label>
        <input type="text" class="form-control" id="new-label" value=${m.getLabel()}>
        ${k}
      </div>
    `,buttons:{cancel:{label:"Cancel",className:"btn-default"},confirm:{label:"Rename",className:"btn-primary",callback(){let S=document.getElementById("new-label").value;const h=t.dataAvail&&m.isObserved()?document.getElementById("label-dropdown").value:"";let M;if(S==m.getLabel()&&h!=""?M=h:M=S,!en(M))return!1;M&&(m.setLabel(M),_&&_.includes(m.getLabel())?(m.link(),ge("success",`Variable ${m.data("label")} linked to data`)):m.isLinked()&&(m.unlink(),ge("info",`Variable ${m.getLabel()} unlinked`)),ie(s.mode))}}},onShown(S){document.getElementById("new-label").addEventListener("keypress",function(h){h.key==="Enter"&&(h.preventDefault(),S.target.querySelector(".btn-primary").click())})}})}},{id:"remove-node",content:"Delete Variable",selector:`node.${me}, node.${le}, node.${Se}`,onClickFunction(c){(c.target||c.cyTarget).remove(),ie(s.mode)},show:"full",hasTrailingDivider:!0},{id:"change-latent",content:"Change to Latent",selector:`node.${le}`,onClickFunction(c){(c.target||c.cyTarget).makeLatent(),ie(s.mode)},show:"full",hasTrailingDivider:!1},{id:"change-ordered",content:"Change to Ordered",selector:`node.${le}.${We}`,onClickFunction(c){const m=c.target||c.cyTarget;m.makeOrdered(),m.connectedEdges().forEach(_=>{_.myIsLoop()&&_.isUserAdded()&&(_.remove(),ge("warning","Removed variance user-defined arrow as it is not allowed for ordered variables."))}),ie(s.mode)},show:"full",hasTrailingDivider:!0},{id:"change-continous",content:"Change to Continous",selector:`node.${le}.${Ye}`,onClickFunction(c){(c.target||c.cyTarget).makeContinous(),ie(s.mode)},show:"full",hasTrailingDivider:!0},{id:"change-observed",show:"full",content:"Change to Observed",selector:`node.${me}`,hasTrailingDivider:!0,onClickFunction(c){const m=c.target||c.cyTarget;m.makeObserved();let _=t.columnNames;_&&_.includes(m.getLabel())&&(m.link(),bootbox.alert("Variable linked with data set")),ie(s.mode)}},{id:"color-node",content:"Change Background Color",selector:"node",show:"both",onClickFunction(c){var m=c.target||c.cyTarget;const _=d(m,"nodes");if(_===null)return null;f(m,_,"nodes")}},{id:"change-border-width",content:"Change Border Width",show:"both",selector:`node.${me}, node.${le}, node.${Se}`,onClickFunction(c){var m=c.target||c.cyTarget;const _=d(m,"nodes");if(_===null)return null;bootbox.prompt({title:"Enter New Border Width:",value:m.style("border-width"),callback(p){p!==null&&o.do("style",{eles:_,style:{"border-width":p}})}})}},{id:"change-font-size",content:"Change Font Size",show:"both",hasTrailingDivider:!0,selector:`node.${me}, node.${le}, node.${Se}, edge`,onClickFunction(c){var m=c.target||c.cyTarget;const _=d(m,"nodes.edges");if(_===null)return null;bootbox.prompt({title:"Enter New Font Size:",value:m.style("font-size"),callback(p){p!==null&&o.do("style",{eles:_,style:{"font-size":p}})}})}}];let a;function f(c,m,_){var p=document.getElementById("picker");p.style.display="block",p.style.left=event.pageX+"px",p.style.top=event.pageY+"px";let k;a=m;const S=function(v){k=v.hexString};l.on("color:change",S);const h=function(v){p.contains(v.target)||(_=="edge"?o.do("style",{eles:a,style:{"line-color":k,"target-arrow-color":k,"source-arrow-color":k}}):o.do("style",{eles:a,style:{"background-color":k}}),p.style.display="none",l.off("color:change",S),document.removeEventListener("click",h),document.removeEventListener("keydown",M))};setTimeout(()=>document.addEventListener("click",h),0);const M=function(v){v.key==="Enter"&&h(v)};document.addEventListener("keydown",M)}const g=Li(u,t.full);return we(()=>{r.contextMenus({menuItems:g})}),[]}class Di extends J{constructor(e){super(),X(this,e,Mi,null,Z,{})}}function Ai(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_,p,k,S,h,M,v,y,E,N;return{c(){e=B("div"),i=B("button"),t=_e("Show Data"),s=x(),r=B("div"),l=B("button"),d=_e("User Model"),a=x(),f=B("button"),g=_e("Autocompleted Model"),m=x(),_=B("button"),p=_e("Estimates"),h=x(),M=B("button"),v=_e("More Results"),C(i,"class","btn btn-lg btn-default"),i.disabled=o=!n[2].dataAvail,C(l,"class",u="btn btn-lg "+(n[1]==="user model"?"btn-primary active":"btn-default")),C(f,"class",c="btn btn-lg "+(n[1]==="full model"?"btn-primary active":"btn-default")),C(_,"class",k="btn btn-lg "+(n[1]==="estimate"?"btn-primary active":"btn-default")),_.disabled=S=!n[2].dataAvail||n[2].modelEmpty,C(r,"class","btn-group btn-toggle svelte-xny576"),C(M,"class","btn btn-lg btn-default"),M.disabled=y=n[0].mode!="estimate",C(e,"class","toolbox navbar-static-bottom svelte-xny576")},m(L,b){F(L,e,b),V(e,i),V(i,t),V(e,s),V(e,r),V(r,l),V(l,d),V(r,a),V(r,f),V(f,g),V(r,m),V(r,_),V(_,p),V(e,h),V(e,M),V(M,v),E||(N=[oe(i,"click",n[6]),oe(l,"click",n[7]),oe(f,"click",n[8]),oe(_,"click",n[9]),oe(M,"click",n[10])],E=!0)},p(L,[b]){b&4&&o!==(o=!L[2].dataAvail)&&(i.disabled=o),b&2&&u!==(u="btn btn-lg "+(L[1]==="user model"?"btn-primary active":"btn-default"))&&C(l,"class",u),b&2&&c!==(c="btn btn-lg "+(L[1]==="full model"?"btn-primary active":"btn-default"))&&C(f,"class",c),b&2&&k!==(k="btn btn-lg "+(L[1]==="estimate"?"btn-primary active":"btn-default"))&&C(_,"class",k),b&4&&S!==(S=!L[2].dataAvail||L[2].modelEmpty)&&(_.disabled=S),b&1&&y!==(y=L[0].mode!="estimate")&&(M.disabled=y)},i:ce,o:ce,d(L){L&&I(e),E=!1,Je(N)}}}function Fi(){window.$("#data-modal-2").modal()}function Ii(n,e,i){let t,o,s;ee(n,te,_=>i(0,t=_)),ee(n,R,_=>i(2,o=_)),ee(n,ue,_=>i(11,s=_));let r;function l(_){i(1,r=_),_!=="user model"?Y(ue,s.showLav=!0,s):Y(ue,s.showLav=!1,s),Y(te,t.mode=_,t)}window.$("#data-modal-extend-results").on("hidden.bs.modal",function(){Y(R,o.showServerErrors=!0,o)});function d(){window.$("#data-modal-extend-results").modal(),Y(R,o.showServerErrors=!1,o)}let u=!1;we(()=>{i(5,u=!0)});const a=()=>Fi(),f=()=>l("user model"),g=()=>l("full model"),c=()=>l("estimate"),m=()=>d();return n.$$.update=()=>{n.$$.dirty&33&&u&&i(1,r=t.mode)},[t,r,o,l,d,u,a,f,g,c,m]}class Oi extends J{constructor(e){super(),X(this,e,Ii,Ai,Z,{})}}function Ni(){return typeof Shiny=="object"&&Shiny!==null}function Ti(n){let e=0,i=Number.NEGATIVE_INFINITY,t=Number.NEGATIVE_INFINITY,o=n.nodes().length;n.nodes().forEach(l=>{let d=l.position();e+=d.x,d.x>i&&(i=d.x),d.y>t&&(t=d.y)});let s=e/o,r=t+100;return{x:s,y:r}}function Pi(n,e){if(!n)throw new Error(e||"Assertion failed")}function xi(n,e,i){let t,o,s;ee(n,te,a=>i(0,t=a)),ee(n,R,a=>i(1,o=a)),ee(n,Fe,a=>i(2,s=a));function r(a,f,g){let c,m,_;return f==="=~"?(c=Oe,m=a,_=g):f=="~1"?(m=1,_=a,c=Oe):(_=a,m=g,f==="~~"?a===g?c=st:c=Ne:c=Oe),{directed:c,source:m,target:_}}function l(a,f,g,c){let m=r(a,f,g);m.user=c;const p=W(K).edges(function(k){let S;if(m.source!=1?(S=k.source().getLabel()==m.source&&k.target().getLabel()==m.target,m.directed==Ne&&(S=S||k.source().getLabel()==m.target&&k.target().getLabel()==m.source)):S=k.source().isConstant()&&k.target().getLabel()==m.target,m.user!=null)if(m.user==1)S=S&&k.isUserAdded();else if(m.user==0)S=S&&k.isLavaanAdded();else throw new Error("User was neither 0 nor 1");return S});if(p.length>1)throw new Error("Multiple edges found");return p}function d(a,f){Y(R,o.meansModelled=!1,o),Y(R,o.loadingMode=!0,o);let g=W(K);if(!f)g.edges().invalidate();else{let k=function(M,v,y){be(M,y,!1,v)};const p=Array.isArray(a.obs)?a.obs:[a.obs];let S={x:200,y:200};for(let M=0;M<p.length;M++)S.x=S.x+50,k(le,p[M],S);const h=Array.isArray(a.latent)?a.latent:[a.latent];S={x:200,y:100};for(let M=0;M<h.length;M++)S.x=S.x+50,k(me,h[M]);a=a.parTable}const c=new Set;for(let p=0;p<a.lhs.length;p++)a.op[p]==="|"&&c.add(a.lhs[p]);let m=!1,_;for(let p=0;p<a.lhs.length;p++){if(a.op[p]=="~*~"||a.op[p]=="|")continue;let k=l(a.lhs[p],a.op[p],a.rhs[p],a.user[p]);if(!f&&a.user[p]==1)Pi(k.length==1),k.validate(),k.isModifiedLavaan()&&k.isFixed()&&k.revertLavaanFix(),a.free[p]==0&&!k.isFixed()&&k.fixPara(a.ustart[p]).markModifiedLavaan();else{let S;if(f||k.length==0){const h=r(a.lhs[p],a.op[p],a.rhs[p]);if(f&&o.full&&a.user[p]==0)continue;let M;if(h.source!==1)M=g.nodes(function(y){return y.getLabel()==h.source})[0].id();else{if(Y(R,o.meansModelled=!0,o),a.free[p]==0&&a.ustart[p]==0)continue;m||(_=be(Se,Ti(g),!1),m=!0,g.nodes(function(E){return E.id()==_})[0].markAddedLavaan()),M=_}const v=g.nodes(function(y){return y.getLabel()==h.target})[0].id();S=g.add({groups:"edges",data:{source:M,target:v},classes:h.directed+" nolabel"}),a.label[p]!=""&&S.addLabelImport(a.label[p]),a.user[p]==1?S.markAddedUser():S.markAddedLavaan(),he(M),he(v)}else!f&&k.length==1&&(S=k);a.free[p]==0?a.ustart[p]!==0&&a.exo[p]!==1?c.has(S.target().getLabel())&&a.op[p]=="~~"?S.fixPara("Total Variance 1"):S.fixPara(a.ustart[p]):S.remove():S.setFree(),f||S.validate()}}f?(ot("tree",!1),g.fit()):(g.edges().forEach(p=>{p.isValid()||p.remove()}),g.getLavaanNodes().forEach(p=>{p.connectedEdges().length==0&&(p.remove(),g.nodes().forEach(k=>{he(k.id())}))})),o.parsedModel||Y(R,o.parsedModel=!0,o),g.getUserEdges().length>0&&Y(R,o.modelEmpty=!1,o),Y(R,o.loadingMode=!1,o)}function u(a,f){W(K);const g=a.op.some(c=>c.includes("~~"));for(let c=0;c<a.lhs.length;c++){if(a.op[c]=="~*~"||a.op[c]=="|")continue;let m=l(a.lhs[c],a.op[c],a.rhs[c]);if(m.length>0){let _={};m.isFree()?(_.est=a.est[c],_.p_value=a.pvalue[c],_.se=a.se[c],_.ciLow=a["ci.lower"][c],_.ciHigh=a["ci.upper"][c],_.est_std=f["est.std"][c],_.se_std=f.se[c],_.ciLow_std=f["ci.lower"][c],_.ciHigh_std=f["ci.upper"][c],m.addClass("hasEst")):g&&a.op[c]=="~~"&&(_.estFixed=a.est[c],_.estFixed_std=f["est.std"][c],m.addClass("hasEstFixed")),m.data("estimates",_)}}}return Ni()&&(Shiny.addCustomMessageHandler("dataInfo",function(a){gt(a.columns),Y(R,o.columnNames=[...a.columns],o),Y(R,o.ids=[...a.columns],o),Y(R,o.loadedFileName=a.name,o),Y(R,o.dataAvail=!0,o),ie(t.mode),window.$("#upload-modal").modal("hide"),a.showData&&window.$("#data-modal-2").modal()}),Shiny.addCustomMessageHandler("lav_failed",function(a){Y(R,o.fitting=!1,o),a=="stopped"?ge("danger","Fitting stopped by user"):ge("danger","Fitting failed")}),Shiny.addCustomMessageHandler("fitting",function(a){Y(R,o.fitting=!0,o)}),Shiny.addCustomMessageHandler("lav_warning_error",function(a){const f=a.type=="warning"?"warning":"error";a.origin=="loading data"&&window.$("#upload-modal").modal("hide"),ge(a.type,`During ${a.origin} the following ${f} occurred: ${a.message}`)}),Shiny.addCustomMessageHandler("lav_error_fitting",function(a){Y(R,o.fitting=!1,o),ge(a.type,"During "+a.origin+" the following error occurred: "+a.message)}),Shiny.addCustomMessageHandler("usecache",function(a){ge("info","Reusing cached results because model and data did not change since last fit")}),Shiny.addCustomMessageHandler("data_missing",function(a){ge("danger","Could not fit model because no data is available")}),Shiny.addCustomMessageHandler("columnames",function(a){const f=W(K),g=o.columnNames[a.index];Y(R,o.columnNames[a.index]=a.newcolname,o),f.getObservedNodes().forEach(c=>{c.getLabel()==g&&(c.setLabel(a.newcolname),ie(t.mode))}),gt(o.columnNames)}),Shiny.addCustomMessageHandler("missing_vars",function(a){var f=[].concat(a).join(", ");ge("danger","Could not fit model because "+f+" are observed variables in the model but not present in the data.")}),Shiny.addCustomMessageHandler("lav_model",function(a){d(a,!1)}),Shiny.addCustomMessageHandler("imported_model",function(a){d(a,!0);let f=W(K);Array.isArray(a.ordered)||(a.ordered=[a.ordered]),a.ordered.forEach(g=>{f.nodes(function(c){return c.getLabel()==g})[0].makeOrdered()}),Y(te,t.fix_first=!1,t),ge("warning","lavaangui only imports user edges. Your full model is very likely different than what you fitted in lavaan because of different options used. To display the model, as you fitted it in lavaan, use plot_lavaan")}),Shiny.addCustomMessageHandler("lav_results",function(a){Y(R,o.loadingMode=!0,o),Y(Fe,s.lastFitLavFit=a.fitted_model,s),Y(Fe,s.lastFitModel=a.model,s),Y(Fe,s.lastFitData=a.data,s),Y(R,o.fitting=!1,o),Y(R,o.loadingMode=!1,o)}),Shiny.addCustomMessageHandler("lav_estimates",function(a){const f=a.normal,g=a.std;u(f,g)}),Shiny.addCustomMessageHandler("setToEstimate",function(a){Y(te,t.mode="estimate",t)})),[]}class Vi extends J{constructor(e){super(),X(this,e,xi,null,Z,{})}}function Ri(n){xn(H);let e=W(K);var i={zoomFactor:.05,zoomDelay:45,minZoom:e.minZoom(),maxZoom:e.maxZoom(),fitPadding:50,panSpeed:10,panDistance:10,panDragAreaSize:75,panMinPercentSpeed:.25,panInactiveArea:8,panIndicatorMinOpacity:.5,zoomOnly:!1,fitSelector:void 0,animateOnFit(){return!1},fitAnimationDuration:1e3};return we(()=>{e.panzoom(i),e.on("zoom",function(t){var o=e.zoom();o<i.minZoom?e.zoom(i.minZoom):o>i.maxZoom&&e.zoom(i.maxZoom)})}),[]}class zi extends J{constructor(e){super(),X(this,e,Ri,null,Z,{})}}function Bi(n){let e,i;const t=n[1].default,o=Xe(t,n,n[0],null);return{c(){e=B("div"),o&&o.c(),C(e,"class","svelte-16igfw6")},m(s,r){F(s,e,r),o&&o.m(e,null),i=!0},p(s,[r]){o&&o.p&&(!i||r&1)&&Ze(o,t,s,s[0],i?Qe(t,s[0],r,null):Ke(s[0]),null)},i(s){i||(D(o,s),i=!0)},o(s){A(o,s),i=!1},d(s){s&&I(e),o&&o.d(s)}}}function Ui(n,e,i){let{$$slots:t={},$$scope:o}=e;return n.$$set=s=>{"$$scope"in s&&i(0,o=s.$$scope)},[o,t]}class Gi extends J{constructor(e){super(),X(this,e,Ui,Bi,Z,{})}}function ji(n,e,i){let t,o;ee(n,Le,r=>i(0,t=r)),ee(n,R,r=>i(1,o=r));let s=W(K);return setInterval(()=>{o.drawing=="none"&&s&&(s.autoungrabify(!1),s.nodes().grabify(),Y(R,o.undoEmpty=t.isUndoStackEmpty(),o),Y(R,o.redoEmpty=t.isRedoStackEmpty(),o))},1e3),window.addEventListener("beforeunload",r=>{r.preventDefault(),r.returnValue=""}),we(()=>{Shiny.unbindAll(),Shiny.bindAll()}),[]}class qi extends J{constructor(e){super(),X(this,e,ji,null,Z,{})}}function tn(n){let e,i,t,o,s,r;return{c(){e=B("div"),i=B("button"),i.innerHTML='<span class="glyphicon glyphicon-refresh spinning svelte-16d2v0h"></span> Fitting...',t=x(),o=B("button"),o.textContent="Cancel",C(i,"class","btn btn-lg btn-secondary fixed-width disabled-button svelte-16d2v0h"),C(i,"id","fitting-button"),i.disabled=!0,C(o,"class","btn btn-lg btn-default fixed-width svelte-16d2v0h"),C(e,"class","center-screen svelte-16d2v0h")},m(l,d){F(l,e,d),V(e,i),V(e,t),V(e,o),s||(r=oe(o,"click",Yi),s=!0)},p:ce,d(l){l&&I(e),s=!1,r()}}}function Hi(n){let e,i=n[0].fitting&&tn();return{c(){i&&i.c(),e=Ue()},m(t,o){i&&i.m(t,o),F(t,e,o)},p(t,[o]){t[0].fitting?i?i.p(t,o):(i=tn(),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null)},i:ce,o:ce,d(t){i&&i.d(t),t&&I(e)}}}function Yi(){Shiny.setInputValue("run-abort",Math.random())}function Wi(n,e,i){let t;return ee(n,R,o=>i(0,t=o)),[t]}class Ji extends J{constructor(e){super(),X(this,e,Wi,Hi,Z,{})}}function nn(n){let e,i,t=n[2][n[0].type].label+"",o,s,r=n[0].message+"",l,d;return{c(){e=B("div"),i=B("strong"),o=_e(t),s=x(),l=_e(r),C(e,"class",d=Ve(n[2][n[0].type].class+(n[1]?" fadeOut":""))+" svelte-1wv9zbn")},m(u,a){F(u,e,a),V(e,i),V(i,o),V(e,s),V(e,l)},p(u,a){a&1&&t!==(t=u[2][u[0].type].label+"")&&Re(o,t),a&1&&r!==(r=u[0].message+"")&&Re(l,r),a&3&&d!==(d=Ve(u[2][u[0].type].class+(u[1]?" fadeOut":""))+" svelte-1wv9zbn")&&C(e,"class",d)},d(u){u&&I(e)}}}function Xi(n){let e,i=n[0].message!==""&&nn(n);return{c(){i&&i.c(),e=Ue()},m(t,o){i&&i.m(t,o),F(t,e,o)},p(t,[o]){t[0].message!==""?i?i.p(t,o):(i=nn(t),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null)},i:ce,o:ce,d(t){i&&i.d(t),t&&I(e)}}}function Zi(n,e,i){let t;ee(n,fn,l=>i(0,t=l));let o={success:{class:"alert-success",label:"Success!"},info:{class:"alert-info",label:"Info!"},warning:{class:"alert-warning",label:"Warning!"},danger:{class:"alert-danger",label:"Danger!"}},s=!1,r;return n.$$.update=()=>{n.$$.dirty&9&&t.message!==""&&(i(1,s=!1),clearTimeout(r),i(3,r=setTimeout(()=>{i(1,s=!0)},1e4)))},[t,s,o,r]}class Ki extends J{constructor(e){super(),X(this,e,Zi,Xi,Z,{})}}function Qi(n,e){const i={};return n.forEach((t,o)=>{i[t]=e[o]}),i}function es(n,e){const i=Object.keys(e);let t={};return i.forEach(o=>{n.hasOwnProperty(o)&&(t[o]=n[o])}),t}function ts(n,e,i){let t,o,s;ee(n,Le,l=>i(0,t=l)),ee(n,R,l=>i(1,o=l)),ee(n,te,l=>i(2,s=l));let r=W(K);return we(()=>{H.use(Vn);const l={isDebug:!0};let d=r.undoRedo(l);Le.set(d),d.action("style",function(u){let a={};const f=Object.keys(u.style);return u.eles.forEach(function(g){let c=[];f.forEach(m=>{c.push(g.data(m)||g.style(m)),g.data(m,u.style[m])}),a[g.id()]=Qi(f,c)}),{eles:u.eles,style:a}},function(u){const a=es(u.eles[0].style(),u.style[Object.keys(u.style)[0]]);return Object.keys(u.style).forEach(function(f){var g=r.getElementById(f);for(var c in u.style[f])g.data(c,u.style[f][c])}),{eles:u.eles,style:a}}),r.on("afterUndo",function(u,a){a!=="style"&&a!=="move"&&ie(s.mode)}),r.on("afterRedo",function(u,a){a!=="style"&&a!=="move"&&ie(s.mode)}),document.addEventListener("keydown",function(u){(u.ctrlKey||u.metaKey)&&u.target.nodeName==="BODY"&&u.which===90&&!o.fitting&&(u.preventDefault(),u.stopPropagation(),u.shiftKey?t.redo():t.undo())}),document.addEventListener("keyup",function(u){u.metaKey&&u.target.nodeName==="BODY"&&u.which===90&&(u.preventDefault(),u.stopPropagation())})}),[]}class ns extends J{constructor(e){super(),X(this,e,ts,null,Z,{})}}function os(n,e,i){let t;return ee(n,R,o=>i(0,t=o)),Shiny.addCustomMessageHandler("fullServer",function(o){Y(R,t.full=o.full,t),Y(R,t.ready=!0,t),Y(R,t.shinyapps=o.shinyapps,t)}),[]}class is extends J{constructor(e){super(),X(this,e,os,null,Z,{})}}function ss(n,e,i){let t;ee(n,ue,s=>i(1,t=s));let o=!1;return we(()=>{i(0,o=!0)}),n.$$.update=()=>{n.$$.dirty&3&&o&&Vo(t.showVar,t.showLav,t.showMean),n.$$.dirty&3&&o&&xo(t.view,t.std,t.number_digits)},[o,t]}class rs extends J{constructor(e){super(),X(this,e,ss,null,Z,{})}}function ls(n){let e,i,t,o;const s=n[6].default,r=Xe(s,n,n[5],null);return{c(){e=B("section"),r&&r.c(),$e(e,"left",n[0]+"px"),$e(e,"top",n[1]+"px"),C(e,"class","draggable svelte-13fkbj1")},m(l,d){F(l,e,d),r&&r.m(e,null),i=!0,t||(o=[oe(window,"mouseup",n[4]),oe(window,"mousemove",n[3]),oe(e,"mousedown",n[2])],t=!0)},p(l,[d]){r&&r.p&&(!i||d&32)&&Ze(r,s,l,l[5],i?Qe(s,l[5],d,null):Ke(l[5]),null),(!i||d&1)&&$e(e,"left",l[0]+"px"),(!i||d&2)&&$e(e,"top",l[1]+"px")},i(l){i||(D(r,l),i=!0)},o(l){A(r,l),i=!1},d(l){l&&I(e),r&&r.d(l),t=!1,Je(o)}}}function as(n,e,i){let{$$slots:t={},$$scope:o}=e,{left:s=100}=e,{top:r=100}=e,l=!1,d=0,u=0;function a(c){l=!0,d=c.clientX-s,u=c.clientY-r}function f(c){l&&(i(0,s=c.clientX-d),i(1,r=c.clientY-u))}function g(){l=!1}return n.$$set=c=>{"left"in c&&i(0,s=c.left),"top"in c&&i(1,r=c.top),"$$scope"in c&&i(5,o=c.$$scope)},[s,r,a,f,g,o,t]}class ds extends J{constructor(e){super(),X(this,e,as,ls,Z,{left:0,top:1})}}function us(n){let e,i,t;const o=n[0].default,s=Xe(o,n,n[1],null);return{c(){e=B("ul"),i=B("div"),s&&s.c(),$e(i,"display","flex"),$e(i,"flex-direction","column"),C(e,"class","nav navbar-nav navbar-left"),$e(e,"border","1px solid black"),$e(e,"z-index","9999")},m(r,l){F(r,e,l),V(e,i),s&&s.m(i,null),t=!0},p(r,l){s&&s.p&&(!t||l&2)&&Ze(s,o,r,r[1],t?Qe(o,r[1],l,null):Ke(r[1]),null)},i(r){t||(D(s,r),t=!0)},o(r){A(s,r),t=!1},d(r){r&&I(e),s&&s.d(r)}}}function cs(n){let e,i;return e=new ds({props:{$$slots:{default:[us]},$$scope:{ctx:n}}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},p(t,[o]){const s={};o&2&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function fs(n,e,i){let{$$slots:t={},$$scope:o}=e;return n.$$set=s=>{"$$scope"in s&&i(1,o=s.$$scope)},[t,o]}class ms extends J{constructor(e){super(),X(this,e,fs,cs,Z,{})}}function gs(n,e){return bootbox.alert({title:"<span style='color: red;'>Error</span>",message:`A ${e} error occurred:<br> <span style='color: red;'>${n}</span>.<br><br>Please consider reporting this issue by sending an email to <a href="mailto:j.d.karch@fsw.leidenuniv.nl">j.d.karch@fsw.leidenuniv.nl</a>.`,centerVertical:!0}),!0}function ps(){return typeof Shiny=="object"&&Shiny!==null}function hs(n){return ps()&&Shiny.addCustomMessageHandler("serverError",function(e){W(R).showServerErrors&&gs(e.msg,"Server")}),[]}class bs extends J{constructor(e){super(),X(this,e,hs,null,Z,{})}}function _s(n,e,i){let t;return ee(n,te,o=>i(0,t=o)),n.$$.update=()=>{n.$$.dirty&1&&ie(t.mode)},[t]}class $s extends J{constructor(e){super(),X(this,e,_s,null,Z,{})}}function vs(n){H.use(Rn);let e=W(K);return we(()=>{e.automove({nodesMatching:".automove-viewport",reposition:"viewport"})}),[]}class ys extends J{constructor(e){super(),X(this,e,vs,null,Z,{})}}function ws(n){zn(H,window.$,cn);let e=W(K);return we(()=>{e.nodeEditing({resizeToContentCueImage:"",undoable:!0})}),[]}class ks extends J{constructor(e){super(),X(this,e,ws,null,Z,{})}}function Es(n){return H("collection","init",function(){return this.addClass(ke).addClass(He).addClass(pe),this}),H("collection","free",function(){return this.hasClass(ke)}),H("collection","addLabel",function(e){return this.addLabelImport(e).removeClass(Pe),this}),H("collection","addLabelImport",function(e){return this.data("label",e).addClass(ze).removeClass(He),this}),H("collection","removeLabel",function(){return this.removeClass(ze).addClass(He).data("label",null),this}),H("collection","setLabel",function(e){return this.data("label",e),this}),H("collection","getLabel",function(){return this.data("label")}),H("collection","fixPara",function(e){return this.data("value",e).removeClass(ke).removeClass(De).removeClass(Lt).addClass(Ee),this}),H("collection","freePara",function(){return this.removeClass(Ee).removeClass(De).removeClass(Pe).addClass(ke),this}),H("collection","setFree",function(){return this.removeClass(Ee).removeClass(De).addClass(ke),this}),H("collection","forceFreePara",function(){return this.removeClass(ke).removeClass(Ee).removeClass(Pe).addClass(De),this}),H("collection","revert",function(){const e=this.source().id(),i=this.target().id();return this.move({source:i,target:e}),this}),H("collection","setUndirected",function(){return this.removeClass(Oe).addClass(Ne),this}),H("collection","setDirected",function(){return this.removeClass(Ne).addClass(Oe),this}),H("collection","isUndirected",function(){return this.hasClass(Ne)}),H("collection","isDirected",function(){return this.hasClass(Oe)}),H("collection","makeLoop",function(){return this.addClass(st),this}),H("collection","myIsLoop",function(){return this.hasClass(st)}),H("collection","makeMeanEdge",function(){return this.data("isMean","1"),this}),H("collection","isMean",function(){return this.data("isMean")==="1"||this.isConstant()}),H("collection","makeOtherEdge",function(){return this.data("isMean","0"),this}),H("collection","isFixed",function(){return this.hasClass(Ee)}),H("collection","isFree",function(){return this.hasClass(ke)||this.hasClass(De)}),H("collection","isForceFree",function(){return this.hasClass(De)}),H("collection","hasLabel",function(){return this.hasClass(ze)}),H("collection","isModifiedLavaan",function(){return this.hasClass(Pe)}),H("collection","markModifiedLavaan",function(){return this.addClass(Pe),this}),H("collection","markAddedLavaan",function(){return this.addClass(Ae).removeClass(pe),this}),H("collection","markAddedUser",function(){return this.removeClass(Ae).addClass(pe),this}),H("collection","isUserAdded",function(){return this.hasClass(pe)}),H("collection","isLavaanAdded",function(){return this.hasClass(Ae)}),H("collection","getValue",function(){return this.data("value")}),H("collection","setValue",function(e){this.data("value",e)}),H("collection","invalidate",function(){return this.removeClass(ut),this}),H("collection","validate",function(){return this.addClass(ut),this}),H("collection","isValid",function(){return this.hasClass(ut)}),H("collection","revertLavaanFix",function(){this.freePara().removeClass(Pe)}),H("collection","removeEstimates",function(){return this.removeClass(Lt).removeClass(jn),this.removeData("estimates"),this}),H("collection","link",function(){return this.addClass(Be),this}),H("collection","unlink",function(){return this.removeClass(Be),this}),H("collection","isLinked",function(){return this.hasClass(Be)}),H("collection","isLatent",function(){return this.hasClass(me)}),H("collection","makeLatent",function(){return this.removeClass(le).addClass(me).removeClass(Be),this}),H("collection","makeObserved",function(){return this.addClass(le).removeClass(me),this}),H("collection","makeOrdered",function(){return this.removeClass(We).addClass(Ye),this}),H("collection","isOrdered",function(){return this.hasClass(Ye)}),H("collection","makeContinous",function(){return this.addClass(We).removeClass(Ye),this}),H("collection","isConstant",function(){return this.hasClass(Se)}),H("collection","isObserved",function(){return this.hasClass(le)}),H("core","getLavaanNodes",function(){return this.nodes(`.${Ae}`)}),H("core","getLavaanEdges",function(){return this.edges(`.${Ae}`)}),H("core","getObservedNodes",function(){return this.nodes(`.${le}`)}),H("core","getUserEdges",function(){return this.edges(`.${pe}`)}),H("core","getLavaanModifiedEdges",function(){return this.edges(`.${Pe}`)}),H("core","getLatentNodes",function(){return this.nodes(function(e){return e.hasClass(me)})}),[]}class Cs extends J{constructor(e){super(),X(this,e,Es,null,Z,{})}}function Ss(n){Bn(H,window.$,cn);let e=W(K);return we(()=>{const i="Bend",t="Kink";e.edgeEditing({undoable:!0,bendRemovalSensitivity:16,enableMultipleAnchorRemovalOption:!0,initAnchorsAutomatically:!1,useTrailingDividersAfterContextMenuOptions:!1,enableCreateAnchorOnDrag:!0,anchorShapeSizeFactor:4,addBendMenuItemTitle:`Add ${t} Point`,removeBendMenuItemTitle:`Remove ${t} Point`,removeAllBendMenuItemTitle:`Remove All${t} Points`,addControlMenuItemTitle:`Add ${i} Point`,removeControlMenuItemTitle:`Remove ${i} Point`,removeAllControlMenuItemTitle:`Remove All ${i} Points`}),e.style().update()}),[]}class Ls extends J{constructor(e){super(),X(this,e,Ss,null,Z,{})}}const on=840;function Ms(n,e,i){let t;ee(n,R,r=>i(0,t=r));function o(){var r=setTimeout(s,on*1e3);window.onmousemove=l,window.onmousedown=l,window.onclick=l,window.onscroll=l,window.onkeypress=l;function l(){clearTimeout(r),r=setTimeout(s,on*1e3)}}async function s(){console.log("Timeout");let r=null,l=null;if(t.dataAvail&&(bn("saveData"),l=await new Promise(u=>{Shiny.addCustomMessageHandler("dataForSave",function(a){u(a)})})),t.modelEmpty||(r=bt()),r!=null||l!=null){bootbox.alert("Due to inactivity, you will be disconnected from the server shortly. Your work was saved for you. In case you have already been disconnected now, you can continue where you left off by refreshing the page.");let u=sessionStorage.getItem("sessionId");u||(u=Date.now().toString(),sessionStorage.setItem("sessionId",u),console.log("Session ID save: ",u));var d=new St("ModelDatabase");d.version(1).stores({cache:"sessionId, model, data"}),await d.cache.clear(),await d.cache.put({sessionId:u,model:r,data:l})}}return we(async()=>{let r=sessionStorage.getItem("sessionId");if(console.log("Session ID load: ",r),r){var l=new St("ModelDatabase");l.version(1).stores({cache:"sessionId, model, data"});const d=await l.cache.get(r);d.model&&(console.log("Model loaded from cache"),ht(d.model)),d.data&&(console.log("Data loaded from cache"),Shiny.setInputValue("dataUpload-fileInput",{content:btoa(d.data)}))}}),o(),[]}class Ds extends J{constructor(e){super(),X(this,e,Ms,null,Z,{})}}function sn(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_,p,k,S,h=n[0].full&&rn();i=new Xn({});const M=[Fs,As],v=[];function y(L,b){return L[0].full?0:1}s=y(n),r=v[s]=M[s](n),d=new Gi({props:{$$slots:{default:[Os]},$$scope:{ctx:n}}});let E=n[0].full&&an();f=new Ci({}),c=new Vi({}),_=new qi({});let N=n[0].shinyapps&&dn();return{c(){h&&h.c(),e=x(),G(i.$$.fragment),t=x(),o=B("div"),r.c(),l=x(),G(d.$$.fragment),u=x(),E&&E.c(),a=x(),G(f.$$.fragment),g=x(),G(c.$$.fragment),m=x(),G(_.$$.fragment),p=x(),N&&N.c(),k=Ue(),C(o,"class","svelte-15ghafl")},m(L,b){h&&h.m(L,b),F(L,e,b),j(i,L,b),F(L,t,b),F(L,o,b),v[s].m(o,null),V(o,l),j(d,o,null),V(o,u),E&&E.m(o,null),F(L,a,b),j(f,L,b),F(L,g,b),j(c,L,b),F(L,m,b),j(_,L,b),F(L,p,b),N&&N.m(L,b),F(L,k,b),S=!0},p(L,b){L[0].full?h?b&1&&D(h,1):(h=rn(),h.c(),D(h,1),h.m(e.parentNode,e)):h&&(ve(),A(h,1,1,()=>{h=null}),ye());let w=s;s=y(L),s!==w&&(ve(),A(v[w],1,1,()=>{v[w]=null}),ye(),r=v[s],r||(r=v[s]=M[s](L),r.c()),D(r,1),r.m(o,l));const z={};b&3&&(z.$$scope={dirty:b,ctx:L}),d.$set(z),L[0].full?E?b&1&&D(E,1):(E=an(),E.c(),D(E,1),E.m(o,null)):E&&(ve(),A(E,1,1,()=>{E=null}),ye()),L[0].shinyapps?N?b&1&&D(N,1):(N=dn(),N.c(),D(N,1),N.m(k.parentNode,k)):N&&(ve(),A(N,1,1,()=>{N=null}),ye())},i(L){S||(D(h),D(i.$$.fragment,L),D(r),D(d.$$.fragment,L),D(E),D(f.$$.fragment,L),D(c.$$.fragment,L),D(_.$$.fragment,L),D(N),S=!0)},o(L){A(h),A(i.$$.fragment,L),A(r),A(d.$$.fragment,L),A(E),A(f.$$.fragment,L),A(c.$$.fragment,L),A(_.$$.fragment,L),A(N),S=!1},d(L){h&&h.d(L),L&&I(e),q(i,L),L&&I(t),L&&I(o),v[s].d(),q(d),E&&E.d(),L&&I(a),q(f,L),L&&I(g),q(c,L),L&&I(m),q(_,L),L&&I(p),N&&N.d(L),L&&I(k)}}}function rn(n){let e,i;return e=new Ji({}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function As(n){let e,i;return e=new ms({props:{$$slots:{default:[Is]},$$scope:{ctx:n}}}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function Fs(n){let e,i;return e=new yi({}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function Is(n){let e,i,t,o,s,r,l,d;return e=new _n({props:{full:!1}}),t=new vn({props:{minimal:!0}}),s=new kn({props:{minimal:!0}}),l=new En({props:{minimal:!0}}),{c(){G(e.$$.fragment),i=x(),G(t.$$.fragment),o=x(),G(s.$$.fragment),r=x(),G(l.$$.fragment)},m(u,a){j(e,u,a),F(u,i,a),j(t,u,a),F(u,o,a),j(s,u,a),F(u,r,a),j(l,u,a),d=!0},p:ce,i(u){d||(D(e.$$.fragment,u),D(t.$$.fragment,u),D(s.$$.fragment,u),D(l.$$.fragment,u),d=!0)},o(u){A(e.$$.fragment,u),A(t.$$.fragment,u),A(s.$$.fragment,u),A(l.$$.fragment,u),d=!1},d(u){q(e,u),u&&I(i),q(t,u),u&&I(o),q(s,u),u&&I(r),q(l,u)}}}function ln(n){let e,i;return e=new ki({}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function Os(n){let e,i,t,o,s,r,l,d,u,a,f,g,c,m,_,p,k,S,h,M,v,y,E,N;e=new co({}),t=new ns({}),s=new Cs({}),l=new Gn({}),u=new ys({}),f=new ks({}),c=new zi({}),_=new Di({}),k=new mo({}),h=new rs({}),v=new Ls({});let L=n[0].full&&ln();return{c(){G(e.$$.fragment),i=x(),G(t.$$.fragment),o=x(),G(s.$$.fragment),r=x(),G(l.$$.fragment),d=x(),G(u.$$.fragment),a=x(),G(f.$$.fragment),g=x(),G(c.$$.fragment),m=x(),G(_.$$.fragment),p=x(),G(k.$$.fragment),S=x(),G(h.$$.fragment),M=x(),G(v.$$.fragment),y=x(),L&&L.c(),E=Ue()},m(b,w){j(e,b,w),F(b,i,w),j(t,b,w),F(b,o,w),j(s,b,w),F(b,r,w),j(l,b,w),F(b,d,w),j(u,b,w),F(b,a,w),j(f,b,w),F(b,g,w),j(c,b,w),F(b,m,w),j(_,b,w),F(b,p,w),j(k,b,w),F(b,S,w),j(h,b,w),F(b,M,w),j(v,b,w),F(b,y,w),L&&L.m(b,w),F(b,E,w),N=!0},p(b,w){b[0].full?L?w&1&&D(L,1):(L=ln(),L.c(),D(L,1),L.m(E.parentNode,E)):L&&(ve(),A(L,1,1,()=>{L=null}),ye())},i(b){N||(D(e.$$.fragment,b),D(t.$$.fragment,b),D(s.$$.fragment,b),D(l.$$.fragment,b),D(u.$$.fragment,b),D(f.$$.fragment,b),D(c.$$.fragment,b),D(_.$$.fragment,b),D(k.$$.fragment,b),D(h.$$.fragment,b),D(v.$$.fragment,b),D(L),N=!0)},o(b){A(e.$$.fragment,b),A(t.$$.fragment,b),A(s.$$.fragment,b),A(l.$$.fragment,b),A(u.$$.fragment,b),A(f.$$.fragment,b),A(c.$$.fragment,b),A(_.$$.fragment,b),A(k.$$.fragment,b),A(h.$$.fragment,b),A(v.$$.fragment,b),A(L),N=!1},d(b){q(e,b),b&&I(i),q(t,b),b&&I(o),q(s,b),b&&I(r),q(l,b),b&&I(d),q(u,b),b&&I(a),q(f,b),b&&I(g),q(c,b),b&&I(m),q(_,b),b&&I(p),q(k,b),b&&I(S),q(h,b),b&&I(M),q(v,b),b&&I(y),L&&L.d(b),b&&I(E)}}}function an(n){let e,i,t,o,s,r;return e=new Ki({}),t=new Oi({}),s=new $s({}),{c(){G(e.$$.fragment),i=x(),G(t.$$.fragment),o=x(),G(s.$$.fragment)},m(l,d){j(e,l,d),F(l,i,d),j(t,l,d),F(l,o,d),j(s,l,d),r=!0},i(l){r||(D(e.$$.fragment,l),D(t.$$.fragment,l),D(s.$$.fragment,l),r=!0)},o(l){A(e.$$.fragment,l),A(t.$$.fragment,l),A(s.$$.fragment,l),r=!1},d(l){q(e,l),l&&I(i),q(t,l),l&&I(o),q(s,l)}}}function dn(n){let e,i;return e=new Ds({}),{c(){G(e.$$.fragment)},m(t,o){j(e,t,o),i=!0},i(t){i||(D(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function Ns(n){let e,i,t,o,s;e=new is({});let r=n[0].ready&&sn(n);return o=new bs({}),{c(){G(e.$$.fragment),i=x(),r&&r.c(),t=x(),G(o.$$.fragment)},m(l,d){j(e,l,d),F(l,i,d),r&&r.m(l,d),F(l,t,d),j(o,l,d),s=!0},p(l,[d]){l[0].ready?r?(r.p(l,d),d&1&&D(r,1)):(r=sn(l),r.c(),D(r,1),r.m(t.parentNode,t)):r&&(ve(),A(r,1,1,()=>{r=null}),ye())},i(l){s||(D(e.$$.fragment,l),D(r),D(o.$$.fragment,l),s=!0)},o(l){A(e.$$.fragment,l),A(r),A(o.$$.fragment,l),s=!1},d(l){q(e,l),l&&I(i),r&&r.d(l),l&&I(t),q(o,l)}}}function Ts(n,e,i){let t;return ee(n,R,o=>i(0,t=o)),[t]}class Ps extends J{constructor(e){super(),X(this,e,Ts,Ns,Z,{})}}new Ps({target:document.getElementById("app")});
